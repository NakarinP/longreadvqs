devtools::load_all(".")
devtools::load_all(".")
## Locate input FASTA files-----------------------------------------------------------------------
sample1filepath <- system.file("extdata", "sample1.fasta", package = "longreadvqs")
sample2filepath <- system.file("extdata", "sample2.fasta", package = "longreadvqs")
sample3filepath <- system.file("extdata", "sample3.fasta", package = "longreadvqs")
## Prepare data for viral quasispecies comparison between three samples---------------------------
sample1 <- vqsassess(sample1filepath, pct = 10, samsize = 100, label = "sample1")
sample2 <- vqsassess(sample2filepath, pct = 10, samsize = 100, label = "sample2")
sample3 <- vqsassess(sample3filepath, pct = 10, samsize = 100, label = "sample3")
sample1$snv
snvcompare(samplelist = list(sample1, sample2, sample3), ncol = 1, barwidth = 2)
snvcompare <- function(samplelist = list(BC1, BC2, BC3), ncol = 1, barwidth = 1){
samplelist = samplelist
list.plot <- purrr::map(samplelist, "snv") %>% as.list()
list.plot2 <- list()
for(i in 1:length(list.plot)) {
list.plot2[[i]] <- list.plot[[i]] + geom_col(width = barwidth) + theme(legend.position = "none") + scale_y_continuous(labels = scales::percent_format(accuracy=1))
}
legend <- suppressWarnings({cowplot::get_legend(list.plot[[1]])})
snvplot0 <- suppressWarnings({cowplot::plot_grid(plotlist = list.plot2, ncol = ncol, align = "v")})
snvplot <- suppressWarnings({cowplot::plot_grid(snvplot0, legend, ncol = 2, rel_widths = c(1, .1))})
return(snvplot)
}
snvcompare(samplelist = list(sample1, sample2, sample3), ncol = 1, barwidth = 2)
devtools::load_all(".")
devtools::load_all(".")
## Locate input FASTA files-----------------------------------------------------------------------
sample1filepath <- system.file("extdata", "sample1.fasta", package = "longreadvqs")
sample2filepath <- system.file("extdata", "sample2.fasta", package = "longreadvqs")
sample3filepath <- system.file("extdata", "sample3.fasta", package = "longreadvqs")
## Prepare data for viral quasispecies comparison between three samples---------------------------
sample1 <- vqsassess(sample1filepath, pct = 10, samsize = 100, label = "sample1")
sample2 <- vqsassess(sample2filepath, pct = 10, samsize = 100, label = "sample2")
sample3 <- vqsassess(sample3filepath, pct = 10, samsize = 100, label = "sample3")
snvcompare(samplelist = list(sample1, sample2, sample3), ncol = 1, barwidth = 2)
devtools::load_all(".")
devtools::load_all(".")
sample1 <- system.file("extdata", "sample1.fasta", package = "longreadvqs")
pctopt(sample1, pctsing = 0, label = "sample1")
a <- pctopt(sample1, pctsing = 0, label = "sample1")
ggplot(a, aes(x=pct, y=pctsingleton)) +
geom_line() + geom_point()
devtools::load_all(".")
devtools::load_all(".")
devtools::load_all(".")
library(longreadvqs)
devtools::load_all(".")
d9_S <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144534_S.fasta", pctsing = 0, label = "d9_S")
d11_S <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144533_S.fasta", pctsing = 0, label = "d11_S")
d13_S <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144530_S.fasta", pctsing = 0, label = "d13_S")
d15_S <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144529_S.fasta", pctsing = 0, label = "d15_S")
d17_S <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144528_S.fasta", pctsing = 0, label = "d17_S")
d9_ORF3a <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144534_ORF3a.fasta", pctsing = 0, label = "d9_ORF3a")
d11_ORF3a <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144533_ORF3a.fasta", pctsing = 0, label = "d11_ORF3a")
d13_ORF3a <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144530_ORF3a.fasta", pctsing = 0, label = "d13_ORF3a")
d15_ORF3a <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144529_ORF3a.fasta", pctsing = 0, label = "d15_ORF3a")
d17_ORF3a <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144528_ORF3a.fasta", pctsing = 0, label = "d17_ORF3a")
d9_E <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144534_E.fasta", pctsing = 0, label = "d9_E")
d11_E <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144533_E.fasta", pctsing = 0, label = "d11_E")
d13_E <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144530_E.fasta", pctsing = 0, label = "d13_E")
d15_E <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144529_E.fasta", pctsing = 0, label = "d15_E")
d17_E <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144528_E.fasta", pctsing = 0, label = "d17_E")
d9_M <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144534_M.fasta", pctsing = 0, label = "d9_M")
d11_M <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144533_M.fasta", pctsing = 0, label = "d11_M")
d13_M <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144530_M.fasta", pctsing = 0, label = "d13_M")
d15_M <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144529_M.fasta", pctsing = 0, label = "d15_M")
d17_M <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144528_M.fasta", pctsing = 0, label = "d17_M")
d9_ORF6 <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144534_ORF6.fasta", pctsing = 0, label = "d9_ORF6")
d11_ORF6 <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144533_ORF6.fasta", pctsing = 0, label = "d11_ORF6")
d13_ORF6 <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144530_ORF6.fasta", pctsing = 0, label = "d13_ORF6")
d15_ORF6 <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144529_ORF6.fasta", pctsing = 0, label = "d15_ORF6")
d17_ORF6 <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144528_ORF6.fasta", pctsing = 0, label = "d17_ORF6")
d9_StoORF6 <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144534_StoORF6.fasta", pctsing = 0, label = "d9_StoORF6")
d11_StoORF6 <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144533_StoORF6.fasta", pctsing = 0, label = "d11_StoORF6")
d13_StoORF6 <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144530_StoORF6.fasta", pctsing = 0, label = "d13_StoORF6")
d15_StoORF6 <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144529_StoORF6.fasta", pctsing = 0, label = "d15_StoORF6")
d17_StoORF6 <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144528_StoORF6.fasta", pctsing = 0, label = "d17_StoORF6")
sarscov2pacbio <- rbind(d9_S, d11_S, d13_S, d15_S, d17_S, d9_ORF3a, d11_ORF3a, d13_ORF3a, d15_ORF3a, d17_ORF3a, d9_E, d11_E, d13_E, d15_E, d17_E, d9_M, d11_M, d13_M, d15_M, d17_M, d9_ORF6, d11_ORF6, d13_ORF6, d15_ORF6, d17_ORF6, d9_StoORF6, d11_StoORF6, d13_StoORF6, d15_StoORF6, d17_StoORF6)
sarscov2pacbio <- sarscov2pacbio %>% separate_wider_delim(label, "_", names = c("sample", "gene"))
write.table(sarscov2pacbio, file = "~/Desktop/bioproj/02newer/sarscov2/pacbio/optpctsarscov2pacbio.tsv", sep = "\t", row.names = FALSE, quote = FALSE)
sarscov2pacbio$gene <- factor(sarscov2pacbio$gene, levels = c("StoORF6", "S", "ORF3a", "M", "E", "ORF6"), ordered = TRUE)
ggplot(sarscov2pacbio, aes(x=pct, y=pctsingleton, group=sample)) +
geom_line(aes(color=sample)) +
geom_point(aes(color=sample)) +
facet_wrap(vars(gene), nrow = 6)
pt11.rev <- vqsassess("~/Desktop/bioproj/02newer/hiv/pacbio/samfasta/gene/hivpacbiosub/SRR16343685_rev.fasta", pct = 35, samsize = 1000, label = "pt11.rev")
devtools::load_all(".")
pt11.rev <- vqsassess("~/Desktop/bioproj/02newer/hiv/pacbio/samfasta/gene/hivpacbiosub/SRR16343685_rev.fasta", pct = 35, samsize = 1000, label = "pt11.rev")
pt12.rev <- vqsassess("~/Desktop/bioproj/02newer/hiv/pacbio/samfasta/gene/hivpacbiosub/SRR16343684_rev.fasta", pct = 35, samsize = 1000, label = "pt12.rev")
pt21.rev <- vqsassess("~/Desktop/bioproj/02newer/hiv/pacbio/samfasta/gene/hivpacbiosub/SRR16343683_rev.fasta", pct = 35, samsize = 1000, label = "pt21.rev")
pt22.rev <- vqsassess("~/Desktop/bioproj/02newer/hiv/pacbio/samfasta/gene/hivpacbiosub/SRR16343682_rev.fasta", pct = 35, samsize = 1000, label = "pt22.rev")
snvcompare(samplelist = list(pt11.rev, pt12.rev, pt21.rev, pt22.rev), ncol = 1)
comprev <- vqscompare(samplelist = list(pt11.rev, pt12.rev, pt21.rev, pt22.rev),
lab_name = "Sample", kmeans.n = 10)
comprev$summaryplot
pt11.env <- vqsassess("~/Desktop/bioproj/02newer/hiv/pacbio/samfasta/gene/hivpacbiosub/SRR16343685_env.fasta", pct = 35, samsize = 1000, label = "pt11.env")
pt11.env <- vqsassess("~/Desktop/bioproj/02newer/hiv/pacbio/samfasta/gene/hivpacbiosub/SRR16343685_env.fasta", pct = 35, samsize = 1000, label = "pt11.env")
pt12.env <- vqsassess("~/Desktop/bioproj/02newer/hiv/pacbio/samfasta/gene/hivpacbiosub/SRR16343684_env.fasta", pct = 35, samsize = 1000, label = "pt12.env")
pt21.env <- vqsassess("~/Desktop/bioproj/02newer/hiv/pacbio/samfasta/gene/hivpacbiosub/SRR16343683_env.fasta", pct = 35, samsize = 1000, label = "pt21.env")
pt22.env <- vqsassess("~/Desktop/bioproj/02newer/hiv/pacbio/samfasta/gene/hivpacbiosub/SRR16343682_env.fasta", pct = 35, samsize = 1000, label = "pt22.env")
snvcompare(samplelist = list(pt11.env, pt12.env, pt21.env, pt22.env), ncol = 1)
compenv <- vqscompare(samplelist = list(pt11.env, pt12.env, pt21.env, pt22.env),
lab_name = "Sample", kmeans.n = 10)
compenv$summaryplot
devtools::load_all(".")
git remote add origin https://github.com/NakarinP/longreadvqs
usethis::create_from_github(
"https://github.com/NakarinP/longreadvqs.git",
destdir = "/Users/nakarinpamornchainavakul/longreadvqs"
)
git remote add origin https://github.com/NakarinP/longreadvqs.git
devtools::load_all(".")
devtools::load_all(".")
devtools::check()
devtools::check_rhub()
devtools::load_all(".")
devtools::check_rhub()
library(rhub)
validate_email()
validate_email(pamor001@umn.edu)
validate_email("pamor001@umn.edu")
devtools::check_rhub()
devtools::load_all(".")
devtools::load_all(".")
devtools::check_rhub()
devtools::load_all(".")
devtools::check_rhub()
devtools::load_all(".")
devtools::document()
devtools::check_rhub()
devtools::check_win_devel()
devtools::spell_check()
devtools::run_examples()
devtools::load_all(".")
lifecycle::last_lifecycle_warnings()
devtools::release()
usethis::use_news_md(open = rlang::is_interactive())
usethis::use_cran_comments(open = rlang::is_interactive())
devtools::load_all(".")
devtools::release()
devtools::load_all(".")
devtools::document()
devtools::load_all(".")
devtools::document()
devtools::check_rhub()
devtools::load_all(".")
devtools::check_rhub()
devtools::load_all(".")
d9.StoORF6 <- vqsassess("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144534_StoORF6.fasta", pct = 1, samsize = 100, label = "d9.StoORF6")
d9.StoORF6 <- vqsassess("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144534_StoORF6.fasta", pct = 1, samsize = 100, label = "d9.StoORF6")
d11.StoORF6 <- vqsassess("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144533_StoORF6.fasta", pct = 1, samsize = 100, label = "d11.StoORF6")
d13.StoORF6 <- vqsassess("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144530_StoORF6.fasta", pct = 1, samsize = 100, label = "d13.StoORF6")
d15.StoORF6 <- vqsassess("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144529_StoORF6.fasta", pct = 1, samsize = 100, label = "d15.StoORF6")
d17.StoORF6 <- vqsassess("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144528_StoORF6.fasta", pct = 1, samsize = 100, label = "d17.StoORF6")
snvStoORF6 <- snvcompare(samplelist = list(d9.StoORF6, d11.StoORF6, d13.StoORF6, d15.StoORF6, d17.StoORF6), ncol = 1)
compStoORF6 <- vqscompare(samplelist = list(d9.StoORF6, d11.StoORF6, d13.StoORF6, d15.StoORF6, d17.StoORF6),
lab_name = "Sample", kmeans.n = 10)
snvStoORF6
compStoORF6$summaryplot
devtools::load_all(".")
hbv <- read.table(file = "~/Desktop/bioproj/02newer/hbv/pacbio/optpcthbvpacbio.tsv", sep = "\t", header = TRUE)
hcv <- read.table(file = "~/Desktop/bioproj/02newer/hcv/pacbio/optpcthcvpacbio.tsv", sep = "\t", header = TRUE)
hiv <- read.table(file = "~/Desktop/bioproj/02newer/hiv/ont/optpcthivnosam.tsv", sep = "\t", header = TRUE)
sarscov2 <- read.table(file = "~/Desktop/bioproj/02newer/sarscov2/pacbio/optpctsarscov2pacbio.tsv", sep = "\t", header = TRUE)
iav <- read.table(file = "~/Desktop/bioproj/02newer/iav/ont/optpctiavnosam.tsv", sep = "\t", header = TRUE)
View(hbv)
View(hcv)
View(sarscov2)
hbv$species <- "HBV"
hcv$species <- "HCV"
hiv$species <- "HIV"
sarscov2$species <- "SARS-CoV-2"
iav$species <- "IAV"
View(hbv)
View(hbv)
hbv <-  hbv %>% mutate(length = case_when(gene == "P" ~ 2499,
gene == "S" ~ 1170))
View(hbv)
View(hcv)
hcv <-  hcv %>% filter(gene == "NS4")
View(hcv)
hcv$length <- 945
View(hcv)
View(hiv)
hiv <-  hiv %>% filter(gene %in% c("rev", "tat", "env", "gag"))
View(hiv)
hiv <-  hiv %>% mutate(length = case_when(gene == "rev" ~ 2684,
gene == "tat" ~ 2594,
gene == "env" ~ 2571,
gene == "gag" ~ 1503))
View(hiv)
View(sarscov2)
View(sarscov2)
sarscov2 <-  sarscov2 %>% filter(gene %in% c("S", "ORF3a", "StoORF6"))
sarscov2 <-  sarscov2 %>% mutate(length = case_when(gene == "S" ~ 3822,
gene == "ORF3a" ~ 828,
gene == "StoORF6" ~ 5825))
View(sarscov2)
View(iav)
iav$species <- "IAV"
iav$length <- 982
View(hiv)
View(iav)
all <- rbind(hbv, hcv, hiv, sarscov2, iav)
View(all)
hbv <- read.table(file = "~/Desktop/bioproj/02newer/hbv/pacbio/optpcthbvpacbio.tsv", sep = "\t", header = TRUE)
hcv <- read.table(file = "~/Desktop/bioproj/02newer/hcv/pacbio/optpcthcvpacbio.tsv", sep = "\t", header = TRUE)
hiv <- read.table(file = "~/Desktop/bioproj/02newer/hiv/ont/optpcthivnosam.tsv", sep = "\t", header = TRUE)
sarscov2 <- read.table(file = "~/Desktop/bioproj/02newer/sarscov2/pacbio/optpctsarscov2pacbio.tsv", sep = "\t", header = TRUE)
iav <- read.table(file = "~/Desktop/bioproj/02newer/iav/ont/optpctiavnosam.tsv", sep = "\t", header = TRUE)
hbv$species <- "HBV"
hbv$tech <- "PacBio"
hbv <-  hbv %>% mutate(length = case_when(gene == "P" ~ 2499,
gene == "S" ~ 1170))
hcv$species <- "HCV"
hcv <-  hcv %>% filter(gene == "NS4")
hcv$tech <- "PacBio"
hcv$length <- 945
hiv$species <- "HIV"
hiv$tech <- "ONT"
hiv <-  hiv %>% filter(gene %in% c("rev", "tat", "env", "gag"))
hiv <-  hiv %>% mutate(length = case_when(gene == "rev" ~ 2684,
gene == "tat" ~ 2594,
gene == "env" ~ 2571,
gene == "gag" ~ 1503))
sarscov2$species <- "SARS-CoV-2"
sarscov2$tech <- "PacBio"
sarscov2 <-  sarscov2 %>% filter(gene %in% c("S", "ORF3a", "StoORF6"))
sarscov2 <-  sarscov2 %>% mutate(length = case_when(gene == "S" ~ 3822,
gene == "ORF3a" ~ 828,
gene == "StoORF6" ~ 5825))
iav$species <- "IAV"
iav$tech <- "ONT"
iav$length <- 982
all <- rbind(hbv, hcv, hiv, sarscov2, iav)
View(all)
ggplot(all, aes(x=pct, y=pctsingleton, group=species)) +
geom_line(aes(color=sample)) +
geom_point(aes(color=sample)) +
facet_wrap(vars(length), nrow = 5)
ggplot(all, aes(x=pct, y=pctsingleton, group=species)) +
geom_line(aes(color=tech)) +
geom_point(aes(color=tech)) +
facet_wrap(vars(length), nrow = 5)
ggplot(all, aes(x=pct, y=pctsingleton, group=sample)) +
geom_line(aes(color=tech)) +
geom_point(aes(color=tech)) +
facet_wrap(vars(length), nrow = 5)
library(seqinr)
d <- read.table(file = "~/Desktop/alphafold/orf6.tsv", sep = "\t", header = TRUE)
View(d)
s <- read.alignment(file = "~/Desktop/alphafold/FinalUSorf6_til8-4-2023.ali.fasta", format = "fasta")
s
str(s)
class(s)
library(purrr)
library(stringr)
s[1]
s[2]
unique(d$year)
l1a <- d %>% filter(sl == "L1A")
l1c <- d %>% filter(sl == "L1C")
unique(l1a$year)
unique(l1c$year)
View(l1a)
l1a2012 <- l1a %>% filter(year == 2012) %>% select(id)
l1a2013 <- l1a %>% filter(year == 2013) %>% select(id)
l1a2014 <- l1a %>% filter(year == 2014) %>% select(id)
l1a2015 <- l1a %>% filter(year == 2015) %>% select(id)
l1a2016 <- l1a %>% filter(year == 2016) %>% select(id)
l1a2017 <- l1a %>% filter(year == 2017) %>% select(id)
l1a2018 <- l1a %>% filter(year == 2018) %>% select(id)
l1a2019 <- l1a %>% filter(year == 2019) %>% select(id)
l1a2020 <- l1a %>% filter(year == 2020) %>% select(id)
l1a2021 <- l1a %>% filter(year == 2021) %>% select(id)
View(l1a2012)
View(l1a2013)
View(l1a2014)
View(l1a2016)
View(l1a2018)
l1c2008 <- l1c %>% filter(year == 2008) %>% select(id)
l1c2011 <- l1c %>% filter(year == 2011) %>% select(id)
l1c2012 <- l1c %>% filter(year == 2012) %>% select(id)
l1c2013 <- l1c %>% filter(year == 2013) %>% select(id)
l1c2014 <- l1c %>% filter(year == 2014) %>% select(id)
l1c2016 <- l1c %>% filter(year == 2016) %>% select(id)
l1c2017 <- l1c %>% filter(year == 2017) %>% select(id)
l1c2018 <- l1c %>% filter(year == 2018) %>% select(id)
l1c2020 <- l1c %>% filter(year == 2020) %>% select(id)
l1c2021 <- l1c %>% filter(year == 2021) %>% select(id)
sl1a2012 <- keep(s, ~ .x[2] %in% l1a2012)
l1a2012
as.list(l1a2019)
l1a2012 <- l1a %>% filter(year == 2012) %>% select(id) %>% as.list()
l1a2013 <- l1a %>% filter(year == 2013) %>% select(id) %>% as.list()
l1a2014 <- l1a %>% filter(year == 2014) %>% select(id) %>% as.list()
l1a2015 <- l1a %>% filter(year == 2015) %>% select(id) %>% as.list()
l1a2016 <- l1a %>% filter(year == 2016) %>% select(id) %>% as.list()
l1a2017 <- l1a %>% filter(year == 2017) %>% select(id) %>% as.list()
l1a2018 <- l1a %>% filter(year == 2018) %>% select(id) %>% as.list()
l1a2019 <- l1a %>% filter(year == 2019) %>% select(id) %>% as.list()
l1a2020 <- l1a %>% filter(year == 2020) %>% select(id) %>% as.list()
l1a2021 <- l1a %>% filter(year == 2021) %>% select(id) %>% as.list()
l1c2008 <- l1c %>% filter(year == 2008) %>% select(id) %>% as.list()
l1c2011 <- l1c %>% filter(year == 2011) %>% select(id) %>% as.list()
l1c2012 <- l1c %>% filter(year == 2012) %>% select(id) %>% as.list()
l1c2013 <- l1c %>% filter(year == 2013) %>% select(id) %>% as.list()
l1c2014 <- l1c %>% filter(year == 2014) %>% select(id) %>% as.list()
l1c2016 <- l1c %>% filter(year == 2016) %>% select(id) %>% as.list()
l1c2017 <- l1c %>% filter(year == 2017) %>% select(id) %>% as.list()
l1c2018 <- l1c %>% filter(year == 2018) %>% select(id) %>% as.list()
l1c2020 <- l1c %>% filter(year == 2020) %>% select(id) %>% as.list()
l1c2021 <- l1c %>% filter(year == 2021) %>% select(id) %>% as.list()
sl1a2012 <- keep(s, ~ .x[2] %in% l1a2012)
a <- c("a", "b", "c")
l1a2012 <- l1a %>% filter(year == 2012) %>% select(id) %>% as.character()
l1a2013 <- l1a %>% filter(year == 2013) %>% select(id) %>% as.character()
l1a2014 <- l1a %>% filter(year == 2014) %>% select(id) %>% as.character()
l1a2015 <- l1a %>% filter(year == 2015) %>% select(id) %>% as.character()
l1a2016 <- l1a %>% filter(year == 2016) %>% select(id) %>% as.character()
l1a2017 <- l1a %>% filter(year == 2017) %>% select(id) %>% as.character()
l1a2018 <- l1a %>% filter(year == 2018) %>% select(id) %>% as.character()
l1a2019 <- l1a %>% filter(year == 2019) %>% select(id) %>% as.character()
l1a2020 <- l1a %>% filter(year == 2020) %>% select(id) %>% as.character()
l1a2021 <- l1a %>% filter(year == 2021) %>% select(id) %>% as.character()
l1c2008 <- l1c %>% filter(year == 2008) %>% select(id) %>% as.character()
l1c2011 <- l1c %>% filter(year == 2011) %>% select(id) %>% as.character()
l1c2012 <- l1c %>% filter(year == 2012) %>% select(id) %>% as.character()
l1c2013 <- l1c %>% filter(year == 2013) %>% select(id) %>% as.character()
l1c2014 <- l1c %>% filter(year == 2014) %>% select(id) %>% as.character()
l1c2016 <- l1c %>% filter(year == 2016) %>% select(id) %>% as.character()
l1c2017 <- l1c %>% filter(year == 2017) %>% select(id) %>% as.character()
l1c2018 <- l1c %>% filter(year == 2018) %>% select(id) %>% as.character()
l1c2020 <- l1c %>% filter(year == 2020) %>% select(id) %>% as.character()
l1c2021 <- l1c %>% filter(year == 2021) %>% select(id) %>% as.character()
sl1a2012 <- keep(s, ~ .x[2] %in% l1a2012)
lia2018
la2018
l1a2018
sl1a2012 <- keep(s, ~ .x[2] %in% l1a2012)
View(sl1a2012)
install.packages("rlist")
library(rlist)
s$nam
sl1a2012 <- list.filter(s, nam %in% l1a2012)
s <- as.list(s)
s$nam
sl1a2012 <- list.filter(s, nam %in% l1a2012)
sl1a2012 <- list.filter(s$nam %in% l1a2012)
sl1a2012 <- list.filter(s, s$nam %in% l1a2012)
View(d)
View(s)
View(d)
setwd("~/Desktop/alphafold/01orf6prep/")
d <- read.table(file = "orf6.tsv", sep = "\t", header = TRUE)
s <- read.alignment(file = "FinalUSorf6_til8-4-2023.ali.fasta", format = "fasta")
l1a <- d %>% filter(sl == "L1A")
l1c <- d %>% filter(sl == "L1C")
l1a2012 <- l1a %>% filter(year == 2012)
write.table(l1a2012[,1], file = "l1a2012.txt", sep = "",  col.names=FALSE, row.names = FALSE, quote = FALSE)
l1a2013 <- l1a %>% filter(year == 2013)
write.table(l1a2013[,1], file = "l1a2013.txt", sep = "",  col.names=FALSE, row.names = FALSE, quote = FALSE)
l1a2014 <- l1a %>% filter(year == 2014)
write.table(l1a2014[,1], file = "l1a2014.txt", sep = "",  col.names=FALSE, row.names = FALSE, quote = FALSE)
l1a2015 <- l1a %>% filter(year == 2015)
write.table(l1a2015[,1], file = "l1a2015.txt", sep = "",  col.names=FALSE, row.names = FALSE, quote = FALSE)
l1a2016 <- l1a %>% filter(year == 2016)
write.table(l1a2016[,1], file = "l1a2016.txt", sep = "",  col.names=FALSE, row.names = FALSE, quote = FALSE)
l1a2017 <- l1a %>% filter(year == 2017)
write.table(l1a2017[,1], file = "l1a2017.txt", sep = "",  col.names=FALSE, row.names = FALSE, quote = FALSE)
l1a2018 <- l1a %>% filter(year == 2018)
write.table(l1a2018[,1], file = "l1a2018.txt", sep = "",  col.names=FALSE, row.names = FALSE, quote = FALSE)
l1a2019 <- l1a %>% filter(year == 2019)
write.table(l1a2019[,1], file = "l1a2019.txt", sep = "",  col.names=FALSE, row.names = FALSE, quote = FALSE)
l1a2020 <- l1a %>% filter(year == 2020)
write.table(l1a2020[,1], file = "l1a2020.txt", sep = "",  col.names=FALSE, row.names = FALSE, quote = FALSE)
l1a2021 <- l1a %>% filter(year == 2021)
write.table(l1a2021[,1], file = "l1a2021.txt", sep = "",  col.names=FALSE, row.names = FALSE, quote = FALSE)
l1c2008 <- l1c %>% filter(year == 2008)
write.table(l1c2008[,1], file = "l1c2008.txt", sep = "",  col.names=FALSE, row.names = FALSE, quote = FALSE)
l1c2011 <- l1c %>% filter(year == 2011)
write.table(l1c2011[,1], file = "l1c2011.txt", sep = "",  col.names=FALSE, row.names = FALSE, quote = FALSE)
l1c2012 <- l1c %>% filter(year == 2012)
write.table(l1c2012[,1], file = "l1c2012.txt", sep = "",  col.names=FALSE, row.names = FALSE, quote = FALSE)
l1c2013 <- l1c %>% filter(year == 2013)
write.table(l1c2013[,1], file = "l1c2013.txt", sep = "",  col.names=FALSE, row.names = FALSE, quote = FALSE)
l1c2014 <- l1c %>% filter(year == 2014)
write.table(l1c2014[,1], file = "l1c2014.txt", sep = "",  col.names=FALSE, row.names = FALSE, quote = FALSE)
l1c2016 <- l1c %>% filter(year == 2016)
write.table(l1c2016[,1], file = "l1c2016.txt", sep = "",  col.names=FALSE, row.names = FALSE, quote = FALSE)
l1c2017 <- l1c %>% filter(year == 2017)
write.table(l1c2017[,1], file = "l1c2017.txt", sep = "",  col.names=FALSE, row.names = FALSE, quote = FALSE)
l1c2018 <- l1c %>% filter(year == 2018)
write.table(l1c2018[,1], file = "l1c2018.txt", sep = "",  col.names=FALSE, row.names = FALSE, quote = FALSE)
l1c2020 <- l1c %>% filter(year == 2020)
write.table(l1c2020[,1], file = "l1c2020.txt", sep = "",  col.names=FALSE, row.names = FALSE, quote = FALSE)
l1c2021 <- l1c %>% filter(year == 2021)
write.table(l1c2021[,1], file = "l1c2021.txt", sep = "",  col.names=FALSE, row.names = FALSE, quote = FALSE)
setwd("~/Desktop/alphafold/01orf6prep/fasta/")
l1a2012 <- read.alignment(file = "l1a2012.fasta", format = "fasta")
l1a2013 <- read.alignment(file = "l1a2013.fasta", format = "fasta")
l1a2014 <- read.alignment(file = "l1a2014.fasta", format = "fasta")
l1a2015 <- read.alignment(file = "l1a2015.fasta", format = "fasta")
l1a2016 <- read.alignment(file = "l1a2016.fasta", format = "fasta")
l1a2017 <- read.alignment(file = "l1a2017.fasta", format = "fasta")
l1a2018 <- read.alignment(file = "l1a2018.fasta", format = "fasta")
l1a2019 <- read.alignment(file = "l1a2019.fasta", format = "fasta")
l1a2020 <- read.alignment(file = "l1a2020.fasta", format = "fasta")
l1a2021 <- read.alignment(file = "l1a2021.fasta", format = "fasta")
l1c2008 <- read.alignment(file = "l1c2008.fasta", format = "fasta")
l1c2011 <- read.alignment(file = "l1c2011.fasta", format = "fasta")
l1c2012 <- read.alignment(file = "l1c2012.fasta", format = "fasta")
l1c2013 <- read.alignment(file = "l1c2013.fasta", format = "fasta")
l1c2014 <- read.alignment(file = "l1c2014.fasta", format = "fasta")
l1c2016 <- read.alignment(file = "l1c2016.fasta", format = "fasta")
l1c2017 <- read.alignment(file = "l1c2017.fasta", format = "fasta")
l1c2018 <- read.alignment(file = "l1c2018.fasta", format = "fasta")
l1c2020 <- read.alignment(file = "l1c2020.fasta", format = "fasta")
l1c2021 <- read.alignment(file = "l1c2021.fasta", format = "fasta")
conl1a2014 <- consensus(l1a2014)
conl1a2014 <- consensus(l1a2014) %>% as.alignment()
View(conl1a2014)
conl1a2014 <- consensus(l1a2014) %>% as.data.frame()
View(conl1a2014)
conl1a2014 <- consensus(l1a2014) %>% as.character()
conl1a2012 <- consensus(l1a2012)
conl1a2013 <- consensus(l1a2013)
conl1a2014 <- consensus(l1a2014)
conl1a2015 <- consensus(l1a2015)
conl1a2016 <- consensus(l1a2016)
conl1a2017 <- consensus(l1a2017)
conl1a2018 <- consensus(l1a2018)
conl1a2019 <- consensus(l1a2019)
conl1a2020 <- consensus(l1a2020)
conl1a2021 <- consensus(l1a2021)
conl1c2008 <- consensus(l1c2008)
conl1c2011 <- consensus(l1c2011)
conl1c2012 <- consensus(l1c2012)
conl1c2013 <- consensus(l1c2013)
conl1c2014 <- consensus(l1c2014)
conl1c2016 <- consensus(l1c2016)
conl1c2017 <- consensus(l1c2017)
conl1c2018 <- consensus(l1c2018)
conl1c2020 <- consensus(l1c2020)
conl1c2021 <- consensus(l1c2021)
all <- data.frame(conl1a2012, conl1a2013, conl1a2014, conl1a2015, conl1a2016, conl1a2017, conl1a2018, conl1a2019, conl1a2020, conl1a2021, conl1c2008, conl1c2011, conl1c2012, conl1c2013, conl1c2014, conl1c2016, conl1c2017, conl1c2018, conl1c2020, conl1c2021)
View(all)
all2 <- data.frame(t(all))
View(all2)
View(all2)
all2$id <- row.names(all2)
View(all2)
conl1a2012 <- consensus(l1a2012)
conl1a2012 <- paste(conl1a2012, collapse = '')
conl1a2013 <- consensus(l1a2013)
conl1a2013 <- paste(conl1a2013, collapse = '')
conl1a2014 <- consensus(l1a2014)
conl1a2014 <- paste(conl1a2014, collapse = '')
conl1a2015 <- consensus(l1a2015)
conl1a2015 <- paste(conl1a2015, collapse = '')
conl1a2016 <- consensus(l1a2016)
conl1a2016 <- paste(conl1a2016, collapse = '')
conl1a2017 <- consensus(l1a2017)
conl1a2017 <- paste(conl1a2017, collapse = '')
conl1a2018 <- consensus(l1a2018)
conl1a2018 <- paste(conl1a2018, collapse = '')
conl1a2019 <- consensus(l1a2019)
conl1a2019 <- paste(conl1a2019, collapse = '')
conl1a2020 <- consensus(l1a2020)
conl1a2020 <- paste(conl1a2020, collapse = '')
conl1a2021 <- consensus(l1a2021)
conl1a2021 <- paste(conl1a2021, collapse = '')
conl1c2008 <- consensus(l1c2008)
conl1c2008 <- paste(conl1c2008, collapse = '')
conl1c2011 <- consensus(l1c2011)
conl1c2011 <- paste(conl1c2011, collapse = '')
conl1c2012 <- consensus(l1c2012)
conl1c2012 <- paste(conl1c2012, collapse = '')
conl1c2013 <- consensus(l1c2013)
conl1c2013 <- paste(conl1c2013, collapse = '')
conl1c2014 <- consensus(l1c2014)
conl1c2014 <- paste(conl1c2014, collapse = '')
conl1c2016 <- consensus(l1c2016)
conl1c2016 <- paste(conl1c2016, collapse = '')
conl1c2017 <- consensus(l1c2017)
conl1c2017 <- paste(conl1c2017, collapse = '')
conl1c2018 <- consensus(l1c2018)
conl1c2018 <- paste(conl1c2018, collapse = '')
conl1c2020 <- consensus(l1c2020)
conl1c2020 <- paste(conl1c2020, collapse = '')
conl1c2021 <- consensus(l1c2021)
conl1c2021 <- paste(conl1c2021, collapse = '')
all <- data.frame(conl1a2012, conl1a2013, conl1a2014, conl1a2015, conl1a2016, conl1a2017, conl1a2018, conl1a2019, conl1a2020, conl1a2021, conl1c2008, conl1c2011, conl1c2012, conl1c2013, conl1c2014, conl1c2016, conl1c2017, conl1c2018, conl1c2020, conl1c2021)
all2 <- data.frame(t(all))
View(all2)
View(all2)
all2$id <- row.names(all2)
names(all2)[names(all2) == 't.all.'] <- 'seq'
View(all2)
writeFasta <- function(data, filename){
fastaLines = c()
for (rowNum in 1:nrow(data)){
fastaLines = c(fastaLines, as.character(paste(">", data[rowNum,"id"], sep = "")))
fastaLines = c(fastaLines, as.character(data[rowNum,"seq"]))
}
fileConn<-file(filename)
writeLines(fastaLines, fileConn)
close(fileConn)
}
writeFasta(all2, yearconsensus.fasta)
writeFasta(all2, "yearconsensus.fasta")
