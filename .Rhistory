theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) + facet_wrap(~samplingwhen, nrow = 2) + ggtitle(nametitle) + theme(legend.title=element_blank())
return(a)
}
pim <- function(data = dataframe, depthorder = depthorder, nametitle = "virus"){
a <- ggplot(data, aes(x = factor(depth, level=depthorder), y = Pim,
group = interaction(depth, sample), fill = sample, color = sample, alpha = 0.2)) + geom_boxplot() +
xlab("depth") + ylab(bquote(π[m])) + theme(legend.position = "bottom", legend.box = "horizontal") + scale_alpha(guide = 'none') +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) + facet_wrap(~samplingwhen, nrow = 2) + ggtitle(nametitle) + theme(legend.title=element_blank())
return(a)
}
gs_1 <- gs(data = hcv, depthorder = depthorder, nametitle = "HCV:NS4")
gs_2 <- gs(data = hbv, depthorder = depthorder, nametitle = "HBV:S")
gs_3 <- gs(data = hiv, depthorder = depthorder, nametitle = "HIV:rev")
gs_4 <- gs(data = sars, depthorder = depthorder, nametitle = "SARS-CoV-2:S")
gs_5 <- gs(data = iav, depthorder = depthorder, nametitle = "IAV:M")
plot_grid(gs_1, gs_2, gs_3, gs_4, gs_5, nrow = 1)
pim_1 <- pim(data = hcv, depthorder = depthorder, nametitle = "HCV:NS4")
pim_2 <- pim(data = hbv, depthorder = depthorder, nametitle = "HBV:S")
pim_3 <- pim(data = hiv, depthorder = depthorder, nametitle = "HIV:rev")
pim_4 <- pim(data = sars, depthorder = depthorder, nametitle = "SARS-CoV-2:S")
pim_5 <- pim(data = iav, depthorder = depthorder, nametitle = "IAV:M")
plot_grid(pim_1, pim_2, pim_3, pim_4, pim_5, nrow = 1)
gs_1 <- gs(data = hcv, depthorder = depthorder, nametitle = "HCV:NS4")
gs_2 <- gs(data = hbv, depthorder = depthorder, nametitle = expression(paste("HBV:", italic("S"))))
gs_3 <- gs(data = hiv, depthorder = depthorder, nametitle = expression(paste("HIV:", italic("env"))))
gs_4 <- gs(data = sars, depthorder = depthorder, nametitle = expression(paste("SARS-CoV-2:", italic("S"))))
gs_5 <- gs(data = iav, depthorder = depthorder, nametitle = "IAV:M")
plot_grid(gs_1, gs_2, gs_3, gs_4, gs_5, nrow = 1)
gs_1 <- gs(data = hcv, depthorder = depthorder, nametitle = "HCV:NS4")
gs_2 <- gs(data = hbv, depthorder = depthorder, nametitle = expression(paste("HBV:", italic("S"))))
gs_3 <- gs(data = hiv, depthorder = depthorder, nametitle = expression(paste("HIV:", italic("env"))))
gs_4 <- gs(data = sars, depthorder = depthorder, nametitle = expression(paste("SARS-CoV-2:", italic("S"))))
gs_5 <- gs(data = iav, depthorder = depthorder, nametitle = "IAV:M")
plot_grid(gs_1, gs_2, gs_3, gs_4, gs_5, nrow = 1)
pim_1 <- pim(data = hcv, depthorder = depthorder, nametitle = "HCV:NS4")
pim_2 <- pim(data = hbv, depthorder = depthorder, nametitle = expression(paste("HBV:", italic("S"))))
pim_3 <- pim(data = hiv, depthorder = depthorder, nametitle = expression(paste("HIV:", italic("env"))))
pim_4 <- pim(data = sars, depthorder = depthorder, nametitle = expression(paste("SARS-CoV-2:", italic("S"))))
pim_5 <- pim(data = iav, depthorder = depthorder, nametitle = "IAV:M")
plot_grid(pim_1, pim_2, pim_3, pim_4, pim_5, nrow = 1)
set.seed(123)
B1.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318387_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B1.M")
B2.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318346_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B2.M")
B4.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318325_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B4.M")
B5.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318324_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B5.M")
C1.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318323_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.C1.M")
C3.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318321_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.C3.M")
C4.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318320_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.C4.M")
snvM <- snvcompare(samplelist = list(B1.M, B2.M, B4.M, B5.M, C1.M, C3.M, C4.M), ncol = 1)
compM <- vqscompare(samplelist = list(B1.M, B2.M, B4.M, B5.M, C1.M, C3.M, C4.M),
lab_name = "Sample", kmeans.n = 10)
compM$summaryplot
set.seed(1234)
B1.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318387_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B1.M")
B2.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318346_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B2.M")
B4.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318325_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B4.M")
B5.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318324_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B5.M")
C1.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318323_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.C1.M")
C3.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318321_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.C3.M")
C4.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318320_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.C4.M")
snvM <- snvcompare(samplelist = list(B1.M, B2.M, B4.M, B5.M, C1.M, C3.M, C4.M), ncol = 1)
compM <- vqscompare(samplelist = list(B1.M, B2.M, B4.M, B5.M, C1.M, C3.M, C4.M),
lab_name = "Sample", kmeans.n = 10)
compM$summaryplot
set.seed(000)
B1.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318387_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B1.M")
B2.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318346_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B2.M")
B4.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318325_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B4.M")
B5.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318324_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B5.M")
C1.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318323_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.C1.M")
C3.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318321_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.C3.M")
C4.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318320_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.C4.M")
snvM <- snvcompare(samplelist = list(B1.M, B2.M, B4.M, B5.M, C1.M, C3.M, C4.M), ncol = 1)
compM <- vqscompare(samplelist = list(B1.M, B2.M, B4.M, B5.M, C1.M, C3.M, C4.M),
lab_name = "Sample", kmeans.n = 10)
compM$summaryplot
set.seed(000)
B1.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318387_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B1.M")
B2.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318346_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B2.M")
B4.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318325_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B4.M")
B5.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318324_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B5.M")
C1.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318323_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.C1.M")
C3.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318321_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.C3.M")
C4.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318320_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.C4.M")
snvM <- snvcompare(samplelist = list(B1.M, B2.M, B4.M, B5.M, C1.M, C3.M, C4.M), ncol = 1)
compM <- vqscompare(samplelist = list(B1.M, B2.M, B4.M, B5.M, C1.M, C3.M, C4.M),
lab_name = "Sample", kmeans.n = 10)
compM$summaryplot
set.seed(0007)
B1.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318387_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B1.M")
B2.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318346_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B2.M")
B4.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318325_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B4.M")
B5.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318324_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B5.M")
C1.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318323_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.C1.M")
C3.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318321_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.C3.M")
C4.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318320_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.C4.M")
snvM <- snvcompare(samplelist = list(B1.M, B2.M, B4.M, B5.M, C1.M, C3.M, C4.M), ncol = 1)
compM <- vqscompare(samplelist = list(B1.M, B2.M, B4.M, B5.M, C1.M, C3.M, C4.M),
lab_name = "Sample", kmeans.n = 10)
compM$summaryplot
set.seed(1111)
B1.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318387_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B1.M")
B2.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318346_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B2.M")
B4.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318325_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B4.M")
B5.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318324_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B5.M")
C1.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318323_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.C1.M")
C3.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318321_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.C3.M")
C4.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318320_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.C4.M")
snvM <- snvcompare(samplelist = list(B1.M, B2.M, B4.M, B5.M, C1.M, C3.M, C4.M), ncol = 1)
compM <- vqscompare(samplelist = list(B1.M, B2.M, B4.M, B5.M, C1.M, C3.M, C4.M),
lab_name = "Sample", kmeans.n = 10)
compM$summaryplot
set.seed(222)
B1.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318387_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B1.M")
B2.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318346_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B2.M")
B4.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318325_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B4.M")
B5.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318324_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B5.M")
C1.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318323_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.C1.M")
C3.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318321_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.C3.M")
C4.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318320_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.C4.M")
snvM <- snvcompare(samplelist = list(B1.M, B2.M, B4.M, B5.M, C1.M, C3.M, C4.M), ncol = 1)
compM <- vqscompare(samplelist = list(B1.M, B2.M, B4.M, B5.M, C1.M, C3.M, C4.M),
lab_name = "Sample", kmeans.n = 10)
compM$summaryplot
set.seed(444)
B1.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318387_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B1.M")
B2.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318346_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B2.M")
B4.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318325_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B4.M")
B5.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318324_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B5.M")
C1.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318323_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.C1.M")
C3.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318321_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.C3.M")
C4.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318320_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.C4.M")
snvM <- snvcompare(samplelist = list(B1.M, B2.M, B4.M, B5.M, C1.M, C3.M, C4.M), ncol = 1)
compM <- vqscompare(samplelist = list(B1.M, B2.M, B4.M, B5.M, C1.M, C3.M, C4.M),
lab_name = "Sample", kmeans.n = 10)
compM$summaryplot
set.seed(666)
B1.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318387_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B1.M")
B2.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318346_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B2.M")
B4.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318325_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B4.M")
B5.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318324_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B5.M")
C1.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318323_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.C1.M")
C3.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318321_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.C3.M")
C4.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318320_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.C4.M")
snvM <- snvcompare(samplelist = list(B1.M, B2.M, B4.M, B5.M, C1.M, C3.M, C4.M), ncol = 1)
compM <- vqscompare(samplelist = list(B1.M, B2.M, B4.M, B5.M, C1.M, C3.M, C4.M),
lab_name = "Sample", kmeans.n = 10)
compM$summaryplot
set.seed(888)
B1.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318387_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B1.M")
B2.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318346_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B2.M")
B4.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318325_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B4.M")
B5.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318324_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B5.M")
C1.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318323_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.C1.M")
C3.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318321_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.C3.M")
C4.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318320_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.C4.M")
snvM <- snvcompare(samplelist = list(B1.M, B2.M, B4.M, B5.M, C1.M, C3.M, C4.M), ncol = 1)
compM <- vqscompare(samplelist = list(B1.M, B2.M, B4.M, B5.M, C1.M, C3.M, C4.M),
lab_name = "Sample", kmeans.n = 10)
compM$summaryplot
set.seed(999)
B1.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318387_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B1.M")
B2.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318346_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B2.M")
B4.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318325_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B4.M")
B5.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318324_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B5.M")
C1.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318323_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.C1.M")
C3.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318321_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.C3.M")
C4.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318320_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.C4.M")
snvM <- snvcompare(samplelist = list(B1.M, B2.M, B4.M, B5.M, C1.M, C3.M, C4.M), ncol = 1)
compM <- vqscompare(samplelist = list(B1.M, B2.M, B4.M, B5.M, C1.M, C3.M, C4.M),
lab_name = "Sample", kmeans.n = 10)
compM$summaryplot
devtools::check()
devtools::check_rhub()
rhub::list_my_checks()
validate_email(email = "pamor001@umn.edu", token = NULL)
rhub::validate_email(email = "pamor001@umn.edu", token = NULL)
rhub::validate_email()
rhub::validate_email(pamor001@umn.edu)
rhub::validate_email("pamor001@umn.edu")
usethis::use_cran_comments(open = rlang::is_interactive())
devtools::install_deps()
devtools::test()
devtools::test_coverage()
devtools::run_examples()
devtools::document()
devtools::check()
devtools::check()
devtools::revdep_check()
revdepcheck::revdep_check()
install.packages(‘revdepcheck’)
install.packages("revdepcheck")
devtools::install_github('r-lib/revdepcheck')
revdepcheck::revdep_check()
devtools::use_travis()
library(rhub)
validate_email()
validate_email("pamor001@umn.edu")
check_rhub()
devtools::check_rhub()
devtools::check_rhub()
pak::pkg_install("r-hub/rhub")
remotes::install_github("r-hub/rhub")
rhub_setup()
library(rhub)
rhub_setup()
rhub_check()
?rhub_check()
rhub_check(gh_url = https://github.com/NakarinP/longreadvqs.git)
rhub_check(gh_url = "https://github.com/NakarinP/longreadvqs.git")
git remote add origin "https://github.com/NakarinP/longreadvqs.git"
git remote add origin https://github.com/NakarinP/longreadvqs.git
rhub_check(gh_url = "https://github.com/NakarinP/longreadvqs.git")
rhub::rhub_setup()
rhub::rhub_doctor()
git remote add origin "https://github.com/NakarinP/longreadvqs.git"
rhub_doctor(gh_url = "https://github.com/NakarinP/longreadvqs.git")
rhub::rhub_check()
rhub::rhub_check(gh_url = "https://github.com/NakarinP/longreadvqs.git")
devtools::load_all(".")
sample1filepath <- system.file("extdata", "s1.fasta", package = "longreadvqs")
sample2filepath <- system.file("extdata", "s2.fasta", package = "longreadvqs")
sample1 <- vqsassess(sample1filepath, pct = 10, samsize = 20, label = "sample1")
sample2 <- vqsassess(sample2filepath, pct = 10, samsize = 20, label = "sample2")
vqscompare(samplelist = list(sample1, sample2),
lab_name = "Sample", kmeans.n = 3, showhap.n = 10)
sample1 <- vqsassess(sample1filepath, pct = 5, samsize = 20, label = "sample1")
sample2 <- vqsassess(sample2filepath, pct = 5, samsize = 20, label = "sample2")
vqscompare(samplelist = list(sample1, sample2),
lab_name = "Sample", kmeans.n = 5, showhap.n = 10)
sample1 <- vqsassess(sample1filepath, pct = 1, samsize = 20, label = "sample1")
sample2 <- vqsassess(sample2filepath, pct = 1, samsize = 20, label = "sample2")
vqscompare(samplelist = list(sample1, sample2),
lab_name = "Sample", kmeans.n = 5, showhap.n = 10)
sample1 <- vqsassess(sample1filepath, pct = 1, samsize = 50, label = "sample1")
sample2 <- vqsassess(sample2filepath, pct = 1, samsize = 50, label = "sample2")
vqscompare(samplelist = list(sample1, sample2),
lab_name = "Sample", kmeans.n = 5, showhap.n = 10)
sample1 <- vqsassess(sample1filepath, pct = 1, samsize = 50, label = "sample1")
sample2 <- vqsassess(sample2filepath, pct = 1, samsize = 50, label = "sample2")
out <- vqscompare(samplelist = list(sample1, sample2),
lab_name = "Sample", kmeans.n = 3, showhap.n = 10)
out$summaryplot
sample1 <- vqsassess(sample1filepath, pct = 0, samsize = 50, label = "sample1")
sample2 <- vqsassess(sample2filepath, pct = 0, samsize = 50, label = "sample2")
out <- vqscompare(samplelist = list(sample1, sample2),
lab_name = "Sample", kmeans.n = 3, showhap.n = 10)
out$summaryplot
sample1filepath <- system.file("extdata", "s1.fasta", package = "longreadvqs")
sample2filepath <- system.file("extdata", "s2.fasta", package = "longreadvqs")
sample1 <- vqsassess(sample1filepath, pct = 0, samsize = 50, label = "sample1")
sample2 <- vqsassess(sample2filepath, pct = 0, samsize = 50, label = "sample2")
out <- vqscompare(samplelist = list(sample1, sample2),
lab_name = "Sample", kmeans.n = 2, showhap.n = 10)
out$summaryplot
set.seed(123)
sample1 <- vqsassess(sample1filepath, pct = 1, samsize = 40, label = "sample1")
sample2 <- vqsassess(sample2filepath, pct = 1, samsize = 40, label = "sample2")
out <- vqscompare(samplelist = list(sample1, sample2),
lab_name = "Sample", kmeans.n = 2, showhap.n = 5)
out$summaryplot
sample1filepath <- system.file("extdata", "s1.fasta", package = "longreadvqs")
sample2filepath <- system.file("extdata", "s2.fasta", package = "longreadvqs")
set.seed(123)
sample1 <- vqsassess(sample1filepath, pct = 1, samsize = 50, label = "sample1")
sample2 <- vqsassess(sample2filepath, pct = 1, samsize = 50, label = "sample2")
out <- vqscompare(samplelist = list(sample1, sample2),
lab_name = "Sample", kmeans.n = 2, showhap.n = 3)
out$summaryplot
sample1filepath <- system.file("extdata", "s1.fasta", package = "longreadvqs")
sample2filepath <- system.file("extdata", "s2.fasta", package = "longreadvqs")
set.seed(123)
sample1 <- vqsassess(sample1filepath, pct = 1, samsize = 50, label = "sample1")
sample2 <- vqsassess(sample2filepath, pct = 1, samsize = 50, label = "sample2")
out <- vqscompare(samplelist = list(sample1, sample2),
lab_name = "Sample", kmeans.n = 2, showhap.n = 3)
out$summaryplot
set.seed(123)
sample1 <- vqsassess(sample1filepath, pct = 0, samsize = 60, label = "sample1")
sample2 <- vqsassess(sample2filepath, pct = 0, samsize = 60, label = "sample2")
out <- vqscompare(samplelist = list(sample1, sample2),
lab_name = "Sample", kmeans.n = 2, showhap.n = 3)
out$summaryplot
sample1filepath <- system.file("extdata", "s1.fasta", package = "longreadvqs")
sample2filepath <- system.file("extdata", "s2.fasta", package = "longreadvqs")
set.seed(123)
sample1 <- vqsassess(sample1filepath, pct = 0, samsize = 60, label = "sample1")
sample2 <- vqsassess(sample2filepath, pct = 0, samsize = 60, label = "sample2")
out <- vqscompare(samplelist = list(sample1, sample2),
lab_name = "Sample", kmeans.n = 2, showhap.n = 3)
out$summaryplot
out <- vqscompare(samplelist = list(sample1, sample2),
lab_name = "Sample", kmeans.n = 3, showhap.n = 3)
out$summaryplot
set.seed(123)
sample1 <- vqsassess(sample1filepath, pct = 0, samsize = 50, label = "sample1")
sample2 <- vqsassess(sample2filepath, pct = 0, samsize = 50, label = "sample2")
out <- vqscompare(samplelist = list(sample1, sample2),
lab_name = "Sample", kmeans.n = 2, showhap.n = 3)
out$summaryplot
rhub_check()
rhub::rhub_check()
rhub::rhub_check(gh_url = "https://github.com/NakarinP/longreadvqs.git")
rhub_doctor(gh_url = "https://github.com/NakarinP/longreadvqs.git")
rhub::rhub_doctor(gh_url = "https://github.com/NakarinP/longreadvqs.git")
rhub::rhub_setup()
rhub_check()
rhub::rhub_check(gh_url = "https://github.com/NakarinP/longreadvqs.git")
devtools::load_all(".")
set.seed(999)
B1.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318387_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B1.M")
B2.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318346_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B2.M")
B4.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318325_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B4.M")
B5.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318324_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B5.M")
C1.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318323_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.C1.M")
C3.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318321_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.C3.M")
C4.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318320_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.C4.M")
snvM <- snvcompare(samplelist = list(B1.M, B2.M, B4.M, B5.M, C1.M, C3.M, C4.M), ncol = 1)
compM <- vqscompare(samplelist = list(B1.M, B2.M, B4.M, B5.M, C1.M, C3.M, C4.M),
lab_name = "Sample", kmeans.n = 10)
compM$summaryplot
compM$fulldata
devtools::load_all(".")
rhub::rhub_check(gh_url = "https://github.com/NakarinP/longreadvqs.git")
packageVersion("QSutils")
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("QSutils")
packageVersion("QSutils")
install_git("https://github.com/VHIRHepatiques/QSutils")
devtools::install_git("https://github.com/VHIRHepatiques/QSutils")
packageVersion("QSutils")
devtools::load_all(".")
sample1filepath <- system.file("extdata", "s1.fasta", package = "longreadvqs")
sample2filepath <- system.file("extdata", "s2.fasta", package = "longreadvqs")
set.seed(123)
sample1 <- vqsassess(sample1filepath, pct = 0, samsize = 50, label = "sample1")
sample2 <- vqsassess(sample2filepath, pct = 0, samsize = 50, label = "sample2")
out <- vqscompare(samplelist = list(sample1, sample2),
lab_name = "Sample", kmeans.n = 2, showhap.n = 3)
out$summaryplot
set.seed(123)
sample1 <- vqsassess(sample1filepath, pct = 5, samsize = 50, label = "sample1")
sample2 <- vqsassess(sample2filepath, pct = 5, samsize = 50, label = "sample2")
out <- vqscompare(samplelist = list(sample1, sample2),
lab_name = "Sample", kmeans.n = 2, showhap.n = 3)
out$summaryplot
out <- vqscompare(samplelist = list(sample1, sample2),
lab_name = "Sample", kmeans.n = 4, showhap.n = 5)
out$summaryplot
devtools::load_all(".")
sample1filepath <- system.file("extdata", "s1.fasta", package = "longreadvqs")
sample2filepath <- system.file("extdata", "s2.fasta", package = "longreadvqs")
set.seed(123)
sample1 <- vqsassess(sample1filepath, pct = 5, samsize = 50, label = "sample1")
sample2 <- vqsassess(sample2filepath, pct = 5, samsize = 50, label = "sample2")
out <- vqscompare(samplelist = list(sample1, sample2),
lab_name = "Sample", kmeans.n = 4, showhap.n = 5)
out$summaryplot
devtools::load_all(".")
out <- vqscompare(samplelist = list(sample1, sample2),
lab_name = "Sample", kmeans.n = 4, showhap.n = 5)
sample1filepath <- system.file("extdata", "s1.fasta", package = "longreadvqs")
sample2filepath <- system.file("extdata", "s2.fasta", package = "longreadvqs")
set.seed(123)
sample1 <- vqsassess(sample1filepath, pct = 5, samsize = 50, label = "sample1")
sample2 <- vqsassess(sample2filepath, pct = 5, samsize = 50, label = "sample2")
out <- vqscompare(samplelist = list(sample1, sample2),
lab_name = "Sample", kmeans.n = 4, showhap.n = 5)
samplelist = list(sample1, sample2)
lab_name = "Sample"
kmeans.n = 4
showhap.n = 5
dss2df <- function(dss) data.frame(width=width(dss), seq=as.character(dss), names=names(dss))
LETTERS702 <- c(LETTERS, sapply(LETTERS, function(x) paste0(x, LETTERS)), sapply(sapply(LETTERS, function(x) paste0(x, LETTERS)), function(x) paste0(x, LETTERS)))
allhap <- do.call(c, purrr::map(samplelist, "hapre"))
comb <- plyr::rbind.fill(purrr::map(samplelist, "snvhap"))
bar <- comb[,c("group", "value", "label", "hap")]
lab <- as.character(do.call(c, purrr::map(samplelist, "lab")))
d.hapdiversity <- plyr::rbind.fill(purrr::map(samplelist, "dat"))
if(missing(lab_name)){
lab_name = "sample name"
}
datall <- dss2df(allhap)
sumall <- datall %>% group_by(seq) %>% summarize(names = paste0(unique(names), collapse = ',')) %>% arrange(desc(str_length(names)), names)
sumall$newgroup <- LETTERS702[1:nrow(sumall)]
sumgroup <- sumall[,2:3] %>% mutate(names = strsplit(as.character(names), ",")) %>% unnest(names)
colnames(sumgroup) <- c("hap", "newgroup")
qual_col_pals = RColorBrewer::brewer.pal.info[RColorBrewer::brewer.pal.info$category == 'qual',]
col_vector = unlist(mapply(RColorBrewer::brewer.pal, qual_col_pals$maxcolors, rownames(qual_col_pals)))
color = grDevices::colors()[grep('gr(a|e)y', grDevices::colors(), invert = T)]
sumallseq <- data.frame(str_split_fixed(sumall$seq, "", max(nchar(sumall$seq))))
colnames(sumallseq) <- paste0(1:ncol(sumallseq))
sumallsnv <- sumallseq[vapply(sumallseq, function(x) length(unique(x)) > 1, logical(1L))]
sumallsnv <- unite(sumallsnv, col='seq', c(names(sumallsnv[1:ncol(sumallsnv)])), sep='')
sumallsnv <- DNAStringSet(c(sumallsnv$seq))
sumallsnv@ranges@NAMES <- c(sumall$newgroup)
sumallsnv <- as.DNAbin(sumallsnv)
distdnasnv <- dist.dna(sumallsnv, pairwise.deletion = FALSE, model = "raw")
dist_sumallsnv <- as.dist(distdnasnv)
mds_sumallsnv <- suppressWarnings({cmdscale(dist_sumallsnv) %>% as_tibble(.name_repair = 'unique')})
colnames(mds_sumallsnv) <- c("Dim.1", "Dim.2")
clust <- kmeans(mds_sumallsnv, kmeans.n)$cluster %>% as.factor()
mds_sumallsnv <- mds_sumallsnv %>% mutate(otu = clust)
mds_sumallsnv$newgroup <- attr(dist_sumallsnv, "Labels")
sumgroup <- inner_join(sumgroup, mds_sumallsnv, by = "newgroup")
bar <- merge(x=bar,y=sumgroup,by="hap",all.x=TRUE)
bar_hap <- bar %>% group_by(newgroup) %>% summarise(nhap = sum(value)) %>% arrange(desc(nhap))
bar_hap$sortgrp <- 1:nrow(bar_hap)
bar_hap <- merge(x=bar,y=bar_hap,by="newgroup",all.x=TRUE) %>% arrange(desc(nhap))
bar_hap <- bar_hap %>% group_by(sortgrp) %>% mutate(mean = mean(nhap)) %>%
ungroup() %>% arrange(desc(mean)) %>% mutate(sortgrp = factor(sortgrp, levels = unique(sortgrp)))
bar_hap <- bar_hap %>% group_by(label) %>% mutate(pct = value/sum(value)) %>% ungroup()
bar_hap_ori <- bar_hap[, c("sortgrp", "hap", "value")] %>% dplyr::rename("hapgroup" = "sortgrp")
bar_hap$sortgrp[bar_hap$value == 1] <- NA
bar_hap$sortgrp <- as.character(bar_hap$sortgrp)
bar_hap$sortgrp <- factor(bar_hap$sortgrp, levels=unique(bar_hap$sortgrp)[order(nchar(unique(bar_hap$sortgrp)), unique(bar_hap$sortgrp))])
colhap <- sample(color, length(unique(bar_hap$sortgrp)), replace = TRUE)
happrop <- ggplot(bar_hap, aes(fill = sortgrp, x=factor(label, levels = lab), y = value)) + geom_bar(colour = "black", position = "fill", stat = "identity") +
scale_fill_manual(values = colhap) + ggtitle("Haplotypes") + theme(legend.position="none", axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) + ylab("proportion") + xlab(lab_name) +
geom_text(aes(label = ifelse(pct > .03, as.character(sortgrp), "")), position = position_fill(vjust = .5))
bar_otu <- bar %>% group_by(otu) %>% summarise(nhap = sum(value)) %>% arrange(desc(nhap))
bar_otu$sortgrp <- LETTERS702[1:nrow(bar_otu)]
bar_otu <- merge(x=bar,y=bar_otu,by="otu",all.x=TRUE) %>% arrange(desc(nhap))
bar_otu_ori <- bar_otu[, c("sortgrp", "hap")] %>% dplyr::rename("otugroup" = "sortgrp")
bar_otu_sum <- aggregate(value ~ sortgrp + label, data = bar_otu, FUN = sum)
bar_otu_sum <- bar_otu_sum %>% group_by(sortgrp) %>% mutate(mean = mean(value)) %>%
ungroup() %>% arrange(desc(mean)) %>% mutate(sortgrp = factor(sortgrp, levels = unique(sortgrp)))
bar_otu_sum <- bar_otu_sum %>% group_by(label) %>% mutate(pct = value/sum(value)) %>% ungroup()
bar_otu_sum$sortgrp <- as.character(bar_otu_sum$sortgrp)
bar_otu_sum$sortgrp <- factor(bar_otu_sum$sortgrp, levels=unique(bar_otu_sum$sortgrp)[order(nchar(unique(bar_otu_sum$sortgrp)), unique(bar_otu_sum$sortgrp))])
colotu <- sample(color, length(unique(bar_otu_sum$sortgrp)), replace = TRUE)
otuprop <- ggplot(bar_otu_sum, aes(fill = sortgrp, x=factor(label, levels = lab), y = value)) + geom_bar(colour = "black", position = "fill", stat = "identity") +
scale_fill_manual(values = colotu) + ggtitle("OTUs") + theme(legend.position="none", axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) + ylab("proportion") + xlab(lab_name) +
geom_text(aes(label = ifelse(pct > .03, as.character(sortgrp), "")), position = position_fill(vjust = .5))
colorder <- as.character(sort(as.numeric(colnames(comb[,!(colnames(comb) %in% c("label", "hap", "group", "value"))]))))
comb <- comb[, c("hap", colorder)]
allsnv <- bar_hap %>% left_join(comb, by="hap") %>% dplyr::rename("hapgroup" = "sortgrp")
otulist <- bar_otu[, c("hap", "sortgrp")] %>% dplyr::rename("otugroup" = "sortgrp")
allsnv <- inner_join(allsnv, otulist, by = "hap")
fullnt <- allsnv[, c("hap", "nhap", "hapgroup")] %>% left_join(datall[, c("seq", "names")], by=c('hap'='names'))
fullnt2 <- fullnt[, c("hapgroup", "nhap", "seq")] %>% distinct() %>% drop_na()
fullntseq <- data.frame(str_split_fixed(fullnt2$seq, "", max(nchar(fullnt2$seq))))
colnames(fullntseq) <- paste0(1:ncol(fullntseq))
fullntsnvs <- fullntseq[vapply(fullntseq, function(x) length(unique(x)) > 1, logical(1L))]
compsnv <- cbind(fullnt2[, c("hapgroup", "nhap")], fullntsnvs)
fullnt_otu <- allsnv[, c("hap", "nhap", "otugroup")] %>% left_join(datall[, c("seq", "names")], by=c('hap'='names'))
fullnt2_otu <- fullnt_otu[, c("otugroup", "nhap", "seq")] %>% distinct() %>% arrange(str_length(otugroup), otugroup, desc(nhap))
fullntseq_otu <- data.frame(str_split_fixed(fullnt2_otu$seq, "", max(nchar(fullnt2_otu$seq))))
colnames(fullntseq_otu) <- paste0(1:ncol(fullntseq_otu))
fullntsnvs_otu <- fullntseq_otu[vapply(fullntseq_otu, function(x) length(unique(x)) > 1, logical(1L))]
compsnv_otu <- cbind(fullnt2_otu[, c("otugroup", "nhap")], fullntsnvs_otu)
hap_otu <- inner_join(bar_hap_ori, bar_otu_ori, by = "hap")
hap_otu <- inner_join(hap_otu, bar_hap[c('hap', 'sortgrp')], by = "hap") %>% dplyr::rename("id" = "hap", "hapgroup2" = "sortgrp")
hap_otu[c('group', 'number')] <- str_split_fixed(hap_otu$id, '_', 2)
mdsdat <- inner_join(allsnv[, c("hap", "otugroup", "hapgroup")], bar_otu[, c("hap", "Dim.1", "Dim.2")], by = "hap")
mdsdat <- unique(subset(mdsdat, select=-c(hap)))
pmds <- suppressWarnings({ggpubr::ggscatter(mdsdat, x = "Dim.1", y = "Dim.2", color = "otugroup", palette = colotu, size =1, ellipse = TRUE, repel = TRUE) +
ggtitle("All OTUs") + theme(legend.position = "none", plot.title = element_text(hjust = 0.5))})
mdsdat2 <- mdsdat
mdsdat2$hapgroup <- as.numeric(mdsdat2$hapgroup)
if(missing(showhap.n)){
mdsdat2$hapgroup[mdsdat2$hapgroup > 30] <- ""
}else{
mdsdat2$hapgroup[mdsdat2$hapgroup > showhap.n] <- ""
}
pmds2 <- suppressWarnings({ggpubr::ggscatter(subset(mdsdat2, otugroup %in% c("A", "B", "C", "D", "E")), x = "Dim.1", y = "Dim.2", color = "otugroup", palette = colotu, size =1, ellipse = TRUE, repel = TRUE, label = "hapgroup") +
ggtitle("Top5 OTUs") + theme(legend.position = "none", plot.title = element_text(hjust = 0.5))})
propcomb <- plot_grid(happrop, otuprop, nrow = 2)
pmdscomb <- plot_grid(pmds2, pmds, nrow = 2)
pmds2
pmds
pmdscomb <- suppressWarnings({plot_grid(pmds2, pmds, nrow = 2)})
sample1filepath <- system.file("extdata", "s1.fasta", package = "longreadvqs")
sample2filepath <- system.file("extdata", "s2.fasta", package = "longreadvqs")
set.seed(123)
sample1 <- vqsassess(sample1filepath, pct = 5, samsize = 50, label = "sample1")
sample2 <- vqsassess(sample2filepath, pct = 5, samsize = 50, label = "sample2")
out <- vqscompare(samplelist = list(sample1, sample2),
lab_name = "Sample", kmeans.n = 4, showhap.n = 5)
devtools::load_all(".")
sample1filepath <- system.file("extdata", "s1.fasta", package = "longreadvqs")
sample2filepath <- system.file("extdata", "s2.fasta", package = "longreadvqs")
set.seed(123)
sample1 <- vqsassess(sample1filepath, pct = 5, samsize = 50, label = "sample1")
sample2 <- vqsassess(sample2filepath, pct = 5, samsize = 50, label = "sample2")
out <- vqscompare(samplelist = list(sample1, sample2),
lab_name = "Sample", kmeans.n = 4, showhap.n = 5)
out$summaryplot
set.seed(999)
B1.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318387_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B1.M")
B2.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318346_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B2.M")
B4.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318325_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B4.M")
B5.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318324_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.B5.M")
C1.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318323_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.C1.M")
C3.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318321_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.C3.M")
C4.M <- vqsassess("~/Desktop/bioproj/02newer/iav/ont/segment/sg7M2M1/SRR23318320_sg7M2M1.fasta", pct = 10, samsize = 130, label = "IAV.C4.M")
snvM <- snvcompare(samplelist = list(B1.M, B2.M, B4.M, B5.M, C1.M, C3.M, C4.M), ncol = 1)
compM <- vqscompare(samplelist = list(B1.M, B2.M, B4.M, B5.M, C1.M, C3.M, C4.M),
lab_name = "Sample", kmeans.n = 10)
compM$summaryplot
devtools::load_all(".")
devtools::check_win_devel()
rhub::rhub_check()
rhub::rhub_check(gh_url = "https://github.com/NakarinP/longreadvqs.git")
devtools::load_all(".")
devtools::spell_check()
devtools::release()
devtools::release()
devtools::load_all(".")
devtools::release()
devtools::release()
