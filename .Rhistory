qual_col_pals = RColorBrewer::brewer.pal.info[RColorBrewer::brewer.pal.info$category == 'qual',]
col_vector = unlist(mapply(RColorBrewer::brewer.pal, qual_col_pals$maxcolors, rownames(qual_col_pals)))
color = grDevices::colors()[grep('gr(a|e)y', grDevices::colors(), invert = T)]
sumallseq <- data.frame(str_split_fixed(sumall$seq, "", max(nchar(sumall$seq))))
colnames(sumallseq) <- paste0(1:ncol(sumallseq))
sumallsnv <- sumallseq[vapply(sumallseq, function(x) length(unique(x)) > 1, logical(1L))]
sumallsnv <- unite(sumallsnv, col='seq', c(names(sumallsnv[1:ncol(sumallsnv)])), sep='')
sumallsnv <- DNAStringSet(c(sumallsnv$seq))
sumallsnv@ranges@NAMES <- c(sumall$newgroup)
sumallsnv <- as.DNAbin(sumallsnv)
distdnasnv <- dist.dna(sumallsnv, pairwise.deletion = FALSE, model = "raw")
dist_sumallsnv <- as.dist(distdnasnv)
mds_sumallsnv <- suppressWarnings({cmdscale(dist_sumallsnv) %>% as_tibble()})
colnames(mds_sumallsnv) <- c("Dim.1", "Dim.2")
clust <- kmeans(mds_sumallsnv, kmeans.n)$cluster %>% as.factor()
mds_sumallsnv <- mds_sumallsnv %>% mutate(otu = clust)
mds_sumallsnv$newgroup <- attr(dist_sumallsnv, "Labels")
sumgroup <- inner_join(sumgroup, mds_sumallsnv, by = "newgroup")
bar <- merge(x=bar,y=sumgroup,by="hap",all.x=TRUE)
bar_hap <- bar %>% group_by(newgroup) %>% summarise(nhap = sum(value)) %>% arrange(desc(nhap))
bar_hap$sortgrp <- LETTERS702[1:nrow(bar_hap)]
bar_hap <- merge(x=bar,y=bar_hap,by="newgroup",all.x=TRUE) %>% arrange(desc(nhap))
bar_hap <- bar_hap %>% group_by(sortgrp) %>% mutate(mean = mean(nhap)) %>%
ungroup() %>% arrange(desc(mean)) %>% mutate(sortgrp = factor(sortgrp, levels = unique(sortgrp)))
bar_hap <- bar_hap %>% group_by(label) %>% mutate(pct = value/sum(value)) %>% ungroup()
bar_hap_ori <- bar_hap[, c("sortgrp", "hap", "value")] %>% dplyr::rename("hapgroup" = "sortgrp")
bar_hap$sortgrp[bar_hap$value == 1] <- NA
bar_hap$sortgrp <- as.character(bar_hap$sortgrp)
bar_hap$sortgrp <- factor(bar_hap$sortgrp, levels=unique(bar_hap$sortgrp)[order(nchar(unique(bar_hap$sortgrp)), unique(bar_hap$sortgrp))])
colhap <- sample(color, length(unique(bar_hap$sortgrp)), replace = TRUE)
happrop <- ggplot(bar_hap, aes(fill = sortgrp, x=factor(label, levels = lab), y = value)) + geom_bar(colour = "black", position = "fill", stat = "identity") +
scale_fill_manual(values = colhap) + ggtitle("Haplotypes (Tip points)") + theme(legend.position="none", axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) + ylab("proportion") + xlab(lab_name) +
geom_text(aes(label = ifelse(pct > .03, as.character(sortgrp), "")), position = position_fill(vjust = .5))
bar_otu <- bar %>% group_by(otu) %>% summarise(nhap = sum(value)) %>% arrange(desc(nhap))
bar_otu$sortgrp <- LETTERS702[1:nrow(bar_otu)]
bar_otu <- merge(x=bar,y=bar_otu,by="otu",all.x=TRUE) %>% arrange(desc(nhap))
bar_otu_ori <- bar_otu[, c("sortgrp", "hap")] %>% dplyr::rename("otugroup" = "sortgrp")
bar_otu_sum <- aggregate(value ~ sortgrp + label, data = bar_otu, FUN = sum)
bar_otu_sum <- bar_otu_sum %>% group_by(sortgrp) %>% mutate(mean = mean(value)) %>%
ungroup() %>% arrange(desc(mean)) %>% mutate(sortgrp = factor(sortgrp, levels = unique(sortgrp)))
bar_otu_sum <- bar_otu_sum %>% group_by(label) %>% mutate(pct = value/sum(value)) %>% ungroup()
bar_otu_sum$sortgrp <- as.character(bar_otu_sum$sortgrp)
bar_otu_sum$sortgrp <- factor(bar_otu_sum$sortgrp, levels=unique(bar_otu_sum$sortgrp)[order(nchar(unique(bar_otu_sum$sortgrp)), unique(bar_otu_sum$sortgrp))])
colotu <- sample(color, length(unique(bar_otu_sum$sortgrp)), replace = TRUE)
otuprop <- ggplot(bar_otu_sum, aes(fill = sortgrp, x=factor(label, levels = lab), y = value)) + geom_bar(colour = "black", position = "fill", stat = "identity") +
scale_fill_manual(values = colotu) + ggtitle("OTUs (Inner ring)") + theme(legend.position="none", axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) + ylab("proportion") + xlab(lab_name) +
geom_text(aes(label = ifelse(pct > .03, as.character(sortgrp), "")), position = position_fill(vjust = .5))
colorder <- as.character(sort(as.numeric(colnames(comb[,!(colnames(comb) %in% c("label", "hap", "group", "value"))]))))
comb <- comb[, c("hap", colorder)]
allsnv <- bar_hap %>% left_join(comb, by="hap") %>% dplyr::rename("hapgroup" = "sortgrp")
otulist <- bar_otu[, c("hap", "sortgrp")] %>% dplyr::rename("otugroup" = "sortgrp")
allsnv <- inner_join(allsnv, otulist, by = "hap")
fullnt <- allsnv[, c("hap", "nhap", "hapgroup")] %>% left_join(datall[, c("seq", "names")], by=c('hap'='names'))
fullnt2 <- fullnt[, c("hapgroup", "nhap", "seq")] %>% distinct() %>% drop_na()
fullntseq <- data.frame(str_split_fixed(fullnt2$seq, "", max(nchar(fullnt2$seq))))
colnames(fullntseq) <- paste0(1:ncol(fullntseq))
fullntsnvs <- fullntseq[vapply(fullntseq, function(x) length(unique(x)) > 1, logical(1L))]
compsnv <- cbind(fullnt2[, c("hapgroup", "nhap")], fullntsnvs)
fullnt_otu <- allsnv[, c("hap", "nhap", "otugroup")] %>% left_join(datall[, c("seq", "names")], by=c('hap'='names'))
fullnt2_otu <- fullnt_otu[, c("otugroup", "nhap", "seq")] %>% distinct() %>% arrange(str_length(otugroup), otugroup, desc(nhap))
fullntseq_otu <- data.frame(str_split_fixed(fullnt2_otu$seq, "", max(nchar(fullnt2_otu$seq))))
colnames(fullntseq_otu) <- paste0(1:ncol(fullntseq_otu))
fullntsnvs_otu <- fullntseq_otu[vapply(fullntseq_otu, function(x) length(unique(x)) > 1, logical(1L))]
compsnv_otu <- cbind(fullnt2_otu[, c("otugroup", "nhap")], fullntsnvs_otu)
hap_otu <- inner_join(bar_hap_ori, bar_otu_ori, by = "hap")
hap_otu <- inner_join(hap_otu, bar_hap[c('hap', 'sortgrp')], by = "hap") %>% dplyr::rename("id" = "hap", "hapgroup2" = "sortgrp")
hap_otu[c('group', 'number')] <- str_split_fixed(hap_otu$id, '_', 2)
datallseq <- data.frame(str_split_fixed(datall$seq, "", max(nchar(datall$seq))))
colnames(datallseq) <- paste0(1:ncol(datallseq))
datallsnv <- datallseq[vapply(datallseq, function(x) length(unique(x)) > 1, logical(1L))]
datallsnv <- unite(datallsnv, col='seq', c(names(datallsnv[1:ncol(datallsnv)])), sep='')
datallsnv <- DNAStringSet(c(datallsnv$seq))
datallsnv@ranges@NAMES <- c(datall$names)
datallsnv <- as.DNAbin(datallsnv)
mt <- modelTest(datallsnv, model=c("JC", "F81", "K80", "HKY", "SYM", "GTR"), control = pml.control(trace = 0))
fdir <- system.file("extdata/trees", package = "phangorn")
primates <- read.phyDat(file.path(fdir, "primates.dna"),
format = "interleaved")
class(primates)
dna_dist <- dist.ml(datallsnv, model="JC69")
dm <- dist.ml(datallsnv, model="JC69")
NJ  <- NJ(dm)
dm <- dist.ml(datallsnv, model="raw")
distsnv <- dist.dna(datallsnv, pairwise.deletion = FALSE, model = "raw")
NJ  <- NJ(distsnv)
class(NJ)
devtools::load_all(".")
devtools::load_all(".")
hbvmix3132_wgs_pct <- pctopt("~/Desktop/bioproj/02newer/hbv/ont/samfasta/gene/wgs/ERR3253560_wgs.fasta", pctsing = 0, label = "hbvmix3132_wgs")
hbv48_wgs_pct <- pctopt("~/Desktop/bioproj/02newer/hbv/ont/samfasta/gene/wgs/ERR3253559_wgs.fasta", pctsing = 0, label = "hbv48_wgs")
hbv32_wgs_pct <- pctopt("~/Desktop/bioproj/02newer/hbv/ont/samfasta/gene/wgs/ERR3253558_wgs.fasta", pctsing = 0, label = "hbv32_wgs")
hbv31_wgs_pct <- pctopt("~/Desktop/bioproj/02newer/hbv/ont/samfasta/gene/wgs/ERR3253557_wgs.fasta", pctsing = 0, label = "hbv31_wgs")
View(hbvmix3132_wgs_pct)
View(hbvmix3132_wgs_pct)
View(hbvmix3132_wgs_pct)
View(hbv48_wgs_pct)
View(hbv32_wgs_pct)
View(hbv31_wgs_pct)
devtools::load_all(".")
hbvmix3132_wgs_pct <- pctopt("~/Desktop/bioproj/02newer/hbv/ont/samfasta/gene/wgs/ERR3253560_wgs.fasta", pctsing = 0, label = "hbvmix3132_wgs")
hbv48_wgs_pct <- pctopt("~/Desktop/bioproj/02newer/hbv/ont/samfasta/gene/wgs/ERR3253559_wgs.fasta", pctsing = 0, label = "hbv48_wgs")
hbv32_wgs_pct <- pctopt("~/Desktop/bioproj/02newer/hbv/ont/samfasta/gene/wgs/ERR3253558_wgs.fasta", pctsing = 0, label = "hbv32_wgs")
hbv31_wgs_pct <- pctopt("~/Desktop/bioproj/02newer/hbv/ont/samfasta/gene/wgs/ERR3253557_wgs.fasta", pctsing = 0, label = "hbv31_wgs")
View(hbvmix3132_wgs_pct)
View(hbv32_wgs_pct)
View(hbv31_wgs_pct)
View(hbvmix3132_wgs_pct)
View(hbv48_wgs_pct)
hbvmix3132_P_pct <- pctopt("~/Desktop/bioproj/02newer/hbv/ont/samfasta/gene/P/ERR3253560_P.fasta", pctsing = 0, label = "hbvmix3132_P")
hbv48_P_pct <- pctopt("~/Desktop/bioproj/02newer/hbv/ont/samfasta/gene/P/ERR3253559_P.fasta", pctsing = 0, label = "hbv48_P")
hbv32_P_pct <- pctopt("~/Desktop/bioproj/02newer/hbv/ont/samfasta/gene/P/ERR3253558_P.fasta", pctsing = 0, label = "hbv32_P")
hbv31_P_pct <- pctopt("~/Desktop/bioproj/02newer/hbv/ont/samfasta/gene/P/ERR3253557_P.fasta", pctsing = 0, label = "hbv31_P")
hbvmix3132_S_pct <- pctopt("~/Desktop/bioproj/02newer/hbv/ont/samfasta/gene/S/ERR3253560_S.fasta", pctsing = 0, label = "hbvmix3132_S")
hbv48_S_pct <- pctopt("~/Desktop/bioproj/02newer/hbv/ont/samfasta/gene/S/ERR3253559_S.fasta", pctsing = 0, label = "hbv48_S")
hbv32_S_pct <- pctopt("~/Desktop/bioproj/02newer/hbv/ont/samfasta/gene/S/ERR3253558_S.fasta", pctsing = 0, label = "hbv32_S")
hbv31_S_pct <- pctopt("~/Desktop/bioproj/02newer/hbv/ont/samfasta/gene/S/ERR3253557_S.fasta", pctsing = 0, label = "hbv31_S")
hbvmix3132_X_pct <- pctopt("~/Desktop/bioproj/02newer/hbv/ont/samfasta/gene/X/ERR3253560_X.fasta", pctsing = 0, label = "hbvmix3132_X")
hbv48_X_pct <- pctopt("~/Desktop/bioproj/02newer/hbv/ont/samfasta/gene/X/ERR3253559_X.fasta", pctsing = 0, label = "hbv48_X")
hbv32_X_pct <- pctopt("~/Desktop/bioproj/02newer/hbv/ont/samfasta/gene/X/ERR3253558_X.fasta", pctsing = 0, label = "hbv32_X")
hbv31_X_pct <- pctopt("~/Desktop/bioproj/02newer/hbv/ont/samfasta/gene/X/ERR3253557_X.fasta", pctsing = 0, label = "hbv31_X")
hbvmix3132_C_pct <- pctopt("~/Desktop/bioproj/02newer/hbv/ont/samfasta/gene/C/ERR3253560_C.fasta", pctsing = 0, label = "hbvmix3132_C")
hbv48_C_pct <- pctopt("~/Desktop/bioproj/02newer/hbv/ont/samfasta/gene/C/ERR3253559_C.fasta", pctsing = 0, label = "hbv48_C")
hbv32_C_pct <- pctopt("~/Desktop/bioproj/02newer/hbv/ont/samfasta/gene/C/ERR3253558_C.fasta", pctsing = 0, label = "hbv32_C")
hbv31_C_pct <- pctopt("~/Desktop/bioproj/02newer/hbv/ont/samfasta/gene/C/ERR3253557_C.fasta", pctsing = 0, label = "hbv31_C")
hbvnosam <- rbind(hbvmix3132_wgs_pct,hbv48_wgs_pct,hbv32_wgs_pct,hbv31_wgs_pct,hbvmix3132_P_pct,hbv48_P_pct,hbv32_P_pct,hbv31_P_pct,hbvmix3132_S_pct,hbv48_S_pct,hbv32_S_pct,hbv31_S_pct,hbvmix3132_X_pct,hbv48_X_pct,hbv32_X_pct,hbv31_X_pct,hbvmix3132_C_pct,hbv48_C_pct,hbv32_C_pct,hbv31_C_pct)
View(hbvnosam)
hbvnosam2 <- hbvnosam %>% separate_wider_delim(label, "_", names = c("sample", "gene"))
View(hbvnosam2)
hbvnosam <- hbvnosam %>% separate_wider_delim(label, "_", names = c("sample", "gene"))
View(hbvnosam)
ggplot(hbvnosam, aes(x=pct, y=pctsingleton, group=sample)) +
geom_line(aes(color=sample)) +
geom_point(aes(color=sample)) +
facet_wrap(vars(gene), nrow = 5)
hbvnosam$gene <- factor(hbvnosam$gene, levels = c("wgs", "P", "S", "C", "X"), ordered = TRUE)
ggplot(hbvnosam, aes(x=pct, y=pctsingleton, group=sample)) +
geom_line(aes(color=sample)) +
geom_point(aes(color=sample)) +
facet_wrap(vars(gene), nrow = 5)
write.table(hbvnosam, file = "~/Desktop/bioproj/02newer/hbv/ont/optpcthbvnosam.tsv", sep = "\t", row.names = FALSE, quote = FALSE)
hiv12hpi_gag <- pctopt("~/Desktop/bioproj/02newer/hiv/ont/samfasta/gene/gag/SRR10123179_gag.fasta", pctsing = 0, label = "hiv12hpi_gag")
hiv14hpi_gag <- pctopt("~/Desktop/bioproj/02newer/hiv/ont/samfasta/gene/gag/SRR10123178_gag.fasta", pctsing = 0, label = "hiv14hpi_gag")
hiv16hpi_gag <- pctopt("~/Desktop/bioproj/02newer/hiv/ont/samfasta/gene/gag/SRR10123177_gag.fasta", pctsing = 0, label = "hiv16hpi_gag")
hiv20hpi_gag <- pctopt("~/Desktop/bioproj/02newer/hiv/ont/samfasta/gene/gag/SRR10123176_gag.fasta", pctsing = 0, label = "hiv20hpi_gag")
hiv24hpi_gag <- pctopt("~/Desktop/bioproj/02newer/hiv/ont/samfasta/gene/gag/SRR10123175_gag.fasta", pctsing = 0, label = "hiv24hpi_gag")
hiv12hpi_vif <- pctopt("~/Desktop/bioproj/02newer/hiv/ont/samfasta/gene/vif/SRR10123179_vif.fasta", pctsing = 0, label = "hiv12hpi_vif")
hiv14hpi_vif <- pctopt("~/Desktop/bioproj/02newer/hiv/ont/samfasta/gene/vif/SRR10123178_vif.fasta", pctsing = 0, label = "hiv14hpi_vif")
hiv16hpi_vif <- pctopt("~/Desktop/bioproj/02newer/hiv/ont/samfasta/gene/vif/SRR10123177_vif.fasta", pctsing = 0, label = "hiv16hpi_vif")
hiv20hpi_vif <- pctopt("~/Desktop/bioproj/02newer/hiv/ont/samfasta/gene/vif/SRR10123176_vif.fasta", pctsing = 0, label = "hiv20hpi_vif")
hiv24hpi_vif <- pctopt("~/Desktop/bioproj/02newer/hiv/ont/samfasta/gene/vif/SRR10123175_vif.fasta", pctsing = 0, label = "hiv24hpi_vif")
hiv12hpi_vpr <- pctopt("~/Desktop/bioproj/02newer/hiv/ont/samfasta/gene/vpr/SRR10123179_vpr.fasta", pctsing = 0, label = "hiv12hpi_vpr")
hiv14hpi_vpr <- pctopt("~/Desktop/bioproj/02newer/hiv/ont/samfasta/gene/vpr/SRR10123178_vpr.fasta", pctsing = 0, label = "hiv14hpi_vpr")
hiv16hpi_vpr <- pctopt("~/Desktop/bioproj/02newer/hiv/ont/samfasta/gene/vpr/SRR10123177_vpr.fasta", pctsing = 0, label = "hiv16hpi_vpr")
hiv20hpi_vpr <- pctopt("~/Desktop/bioproj/02newer/hiv/ont/samfasta/gene/vpr/SRR10123176_vpr.fasta", pctsing = 0, label = "hiv20hpi_vpr")
hiv24hpi_vpr <- pctopt("~/Desktop/bioproj/02newer/hiv/ont/samfasta/gene/vpr/SRR10123175_vpr.fasta", pctsing = 0, label = "hiv24hpi_vpr")
hiv12hpi_tat <- pctopt("~/Desktop/bioproj/02newer/hiv/ont/samfasta/gene/tat/SRR10123179_tat.fasta", pctsing = 0, label = "hiv12hpi_tat")
hiv14hpi_tat <- pctopt("~/Desktop/bioproj/02newer/hiv/ont/samfasta/gene/tat/SRR10123178_tat.fasta", pctsing = 0, label = "hiv14hpi_tat")
hiv16hpi_tat <- pctopt("~/Desktop/bioproj/02newer/hiv/ont/samfasta/gene/tat/SRR10123177_tat.fasta", pctsing = 0, label = "hiv16hpi_tat")
hiv20hpi_tat <- pctopt("~/Desktop/bioproj/02newer/hiv/ont/samfasta/gene/tat/SRR10123176_tat.fasta", pctsing = 0, label = "hiv20hpi_tat")
hiv24hpi_tat <- pctopt("~/Desktop/bioproj/02newer/hiv/ont/samfasta/gene/tat/SRR10123175_tat.fasta", pctsing = 0, label = "hiv24hpi_tat")
hiv12hpi_rev <- pctopt("~/Desktop/bioproj/02newer/hiv/ont/samfasta/gene/rev/SRR10123179_rev.fasta", pctsing = 0, label = "hiv12hpi_rev")
hiv14hpi_rev <- pctopt("~/Desktop/bioproj/02newer/hiv/ont/samfasta/gene/rev/SRR10123178_rev.fasta", pctsing = 0, label = "hiv14hpi_rev")
hiv16hpi_rev <- pctopt("~/Desktop/bioproj/02newer/hiv/ont/samfasta/gene/rev/SRR10123177_rev.fasta", pctsing = 0, label = "hiv16hpi_rev")
hiv20hpi_rev <- pctopt("~/Desktop/bioproj/02newer/hiv/ont/samfasta/gene/rev/SRR10123176_rev.fasta", pctsing = 0, label = "hiv20hpi_rev")
hiv24hpi_rev <- pctopt("~/Desktop/bioproj/02newer/hiv/ont/samfasta/gene/rev/SRR10123175_rev.fasta", pctsing = 0, label = "hiv24hpi_rev")
hiv12hpi_vpu <- pctopt("~/Desktop/bioproj/02newer/hiv/ont/samfasta/gene/vpu/SRR10123179_vpu.fasta", pctsing = 0, label = "hiv12hpi_vpu")
hiv14hpi_vpu <- pctopt("~/Desktop/bioproj/02newer/hiv/ont/samfasta/gene/vpu/SRR10123178_vpu.fasta", pctsing = 0, label = "hiv14hpi_vpu")
hiv16hpi_vpu <- pctopt("~/Desktop/bioproj/02newer/hiv/ont/samfasta/gene/vpu/SRR10123177_vpu.fasta", pctsing = 0, label = "hiv16hpi_vpu")
hiv20hpi_vpu <- pctopt("~/Desktop/bioproj/02newer/hiv/ont/samfasta/gene/vpu/SRR10123176_vpu.fasta", pctsing = 0, label = "hiv20hpi_vpu")
hiv24hpi_vpu <- pctopt("~/Desktop/bioproj/02newer/hiv/ont/samfasta/gene/vpu/SRR10123175_vpu.fasta", pctsing = 0, label = "hiv24hpi_vpu")
hiv12hpi_env <- pctopt("~/Desktop/bioproj/02newer/hiv/ont/samfasta/gene/env/SRR10123179_env.fasta", pctsing = 0, label = "hiv12hpi_env")
hiv14hpi_env <- pctopt("~/Desktop/bioproj/02newer/hiv/ont/samfasta/gene/env/SRR10123178_env.fasta", pctsing = 0, label = "hiv14hpi_env")
hiv16hpi_env <- pctopt("~/Desktop/bioproj/02newer/hiv/ont/samfasta/gene/env/SRR10123177_env.fasta", pctsing = 0, label = "hiv16hpi_env")
hiv20hpi_env <- pctopt("~/Desktop/bioproj/02newer/hiv/ont/samfasta/gene/env/SRR10123176_env.fasta", pctsing = 0, label = "hiv20hpi_env")
hiv24hpi_env <- pctopt("~/Desktop/bioproj/02newer/hiv/ont/samfasta/gene/env/SRR10123175_env.fasta", pctsing = 0, label = "hiv24hpi_env")
hiv12hpi_asp <- pctopt("~/Desktop/bioproj/02newer/hiv/ont/samfasta/gene/asp/SRR10123179_asp.fasta", pctsing = 0, label = "hiv12hpi_asp")
hiv14hpi_asp <- pctopt("~/Desktop/bioproj/02newer/hiv/ont/samfasta/gene/asp/SRR10123178_asp.fasta", pctsing = 0, label = "hiv14hpi_asp")
hiv16hpi_asp <- pctopt("~/Desktop/bioproj/02newer/hiv/ont/samfasta/gene/asp/SRR10123177_asp.fasta", pctsing = 0, label = "hiv16hpi_asp")
hiv20hpi_asp <- pctopt("~/Desktop/bioproj/02newer/hiv/ont/samfasta/gene/asp/SRR10123176_asp.fasta", pctsing = 0, label = "hiv20hpi_asp")
hiv24hpi_asp <- pctopt("~/Desktop/bioproj/02newer/hiv/ont/samfasta/gene/asp/SRR10123175_asp.fasta", pctsing = 0, label = "hiv24hpi_asp")
hiv12hpi_nef <- pctopt("~/Desktop/bioproj/02newer/hiv/ont/samfasta/gene/nef/SRR10123179_nef.fasta", pctsing = 0, label = "hiv12hpi_nef")
hiv14hpi_nef <- pctopt("~/Desktop/bioproj/02newer/hiv/ont/samfasta/gene/nef/SRR10123178_nef.fasta", pctsing = 0, label = "hiv14hpi_nef")
hiv16hpi_nef <- pctopt("~/Desktop/bioproj/02newer/hiv/ont/samfasta/gene/nef/SRR10123177_nef.fasta", pctsing = 0, label = "hiv16hpi_nef")
hiv20hpi_nef <- pctopt("~/Desktop/bioproj/02newer/hiv/ont/samfasta/gene/nef/SRR10123176_nef.fasta", pctsing = 0, label = "hiv20hpi_nef")
hiv24hpi_nef <- pctopt("~/Desktop/bioproj/02newer/hiv/ont/samfasta/gene/nef/SRR10123175_nef.fasta", pctsing = 0, label = "hiv24hpi_nef")
hivnosam <- rbind(hiv12hpi_gag, hiv14hpi_gag, hiv16hpi_gag, hiv20hpi_gag, hiv24hpi_gag, hiv12hpi_vif, hiv14hpi_vif, hiv16hpi_vif, hiv20hpi_vif, hiv24hpi_vif, hiv12hpi_vpr, hiv14hpi_vpr, hiv16hpi_vpr, hiv20hpi_vpr, hiv24hpi_vpr, hiv12hpi_tat, hiv14hpi_tat, hiv16hpi_tat, hiv20hpi_tat, hiv24hpi_tat, hiv12hpi_rev, hiv14hpi_rev, hiv16hpi_rev, hiv20hpi_rev, hiv24hpi_rev, hiv12hpi_vpu, hiv14hpi_vpu, hiv16hpi_vpu, hiv20hpi_vpu, hiv24hpi_vpu, hiv12hpi_env, hiv14hpi_env, hiv16hpi_env, hiv20hpi_env, hiv24hpi_env, hiv12hpi_asp, hiv14hpi_asp, hiv16hpi_asp, hiv20hpi_asp, hiv24hpi_asp, hiv12hpi_nef, hiv14hpi_nef, hiv16hpi_nef, hiv20hpi_nef, hiv24hpi_nef)
hivnosam <- hivnosam %>% separate_wider_delim(label, "_", names = c("sample", "gene"))
View(hivnosam)
write.table(hivnosam, file = "~/Desktop/bioproj/02newer/hiv/ont/optpcthivnosam.tsv", sep = "\t", row.names = FALSE, quote = FALSE)
hivnosam$gene <- factor(hivnosam$gene, levels = c("rev", "tat", "env", "gag", "nef", "vif", "asp", "vpr", "vpu"), ordered = TRUE)
ggplot(hivnosam, aes(x=pct, y=pctsingleton, group=sample)) +
geom_line(aes(color=sample)) +
geom_point(aes(color=sample)) +
facet_wrap(vars(gene), nrow = 9)
hivnosam <- rbind(hiv14hpi_gag,hiv16hpi_gag,hiv20hpi_gag,hiv24hpi_gag,hiv14hpi_vif,hiv16hpi_vif,hiv20hpi_vif,hiv24hpi_vif,hiv14hpi_vpr,hiv16hpi_vpr,hiv20hpi_vpr,hiv24hpi_vpr,hiv14hpi_tat,hiv16hpi_tat,hiv20hpi_tat,hiv24hpi_tat,hiv14hpi_rev,hiv16hpi_rev,hiv20hpi_rev,hiv24hpi_rev,hiv14hpi_vpu,hiv16hpi_vpu,hiv20hpi_vpu,hiv24hpi_vpu,hiv14hpi_env,hiv16hpi_env,hiv20hpi_env,hiv24hpi_env,hiv14hpi_asp,hiv16hpi_asp,hiv20hpi_asp,hiv24hpi_asp,hiv14hpi_nef,hiv16hpi_nef,hiv20hpi_nef,hiv24hpi_nef)
hivnosam <- hivnosam %>% separate_wider_delim(label, "_", names = c("sample", "gene"))
write.table(hivnosam, file = "~/Desktop/bioproj/02newer/hiv/ont/optpcthivnosam.tsv", sep = "\t", row.names = FALSE, quote = FALSE)
hivnosam$gene <- factor(hivnosam$gene, levels = c("rev", "tat", "env", "gag", "nef", "vif", "asp", "vpr", "vpu"), ordered = TRUE)
ggplot(hivnosam, aes(x=pct, y=pctsingleton, group=sample)) +
geom_line(aes(color=sample)) +
geom_point(aes(color=sample)) +
facet_wrap(vars(gene), nrow = 9)
devtools::load_all(".")
devtools::load_all(".")
?pctopt
devtools::load_all(".")
?pctopt
devtools::load_all(".")
pt11.wgs <- vqsassess("~/Desktop/bioproj/02newer/hiv/pacbio/samfasta/gene/wgs/sub/SRR16343685_wgs.fasta", pct = 35, samsize = 500, label = "pt11.wgs")
pt12.wgs <- vqsassess("~/Desktop/bioproj/02newer/hiv/pacbio/samfasta/gene/wgs/sub/SRR16343684_wgs.fasta", pct = 35, samsize = 500, label = "pt12.wgs")
pt21.wgs <- vqsassess("~/Desktop/bioproj/02newer/hiv/pacbio/samfasta/gene/wgs/sub/SRR16343683_wgs.fasta", pct = 35, samsize = 500, label = "pt21.wgs")
devtools::load_all(".")
## Locate input FASTA files-----------------------------------------------------------------------
sample1filepath <- system.file("extdata", "sample1.fasta", package = "longreadvqs")
sample2filepath <- system.file("extdata", "sample2.fasta", package = "longreadvqs")
sample3filepath <- system.file("extdata", "sample3.fasta", package = "longreadvqs")
sample4filepath <- system.file("extdata", "sample4.fasta", package = "longreadvqs")
## Prepare data for viral quasispecies comparison between four samples----------------------------
sample1 <- vqsassess(sample1filepath, pct = 10, samsize = 100, label = "sample1")
sample2 <- vqsassess(sample2filepath, pct = 10, samsize = 100, label = "sample2")
sample3 <- vqsassess(sample3filepath, pct = 10, samsize = 100, label = "sample3")
sample4 <- vqsassess(sample4filepath, pct = 10, samsize = 100, label = "sample4")
## Compare viral quasispecies and OTU (10 clusters) diversity between four samples----------------
comp <- vqscompare(samplelist = list(sample1, sample2, sample3, sample4),
lab_name = "Sample", kmeans.n = 10)
comp$summaryplot
devtools::load_all(".")
devtools::load_all(".")
devtools::load_all(".")
devtools::load_all(".")
devtools::load_all(".")
devtools::load_all(".")
library(longreadvqs)
#Load sample 1.
sample1 <- system.file("extdata", "sample1.fasta", package = "longreadvqs")
#VQS diversity metrics of error minimized (10% cut-off) read alignment
vqssub(sample1, pct = 10, label = "sample1")
#List outputs from "vqsassess" or "vqscustompct" that we want to compare into "vqscompare" function.
#Set the number of new OTU groups based on k-means clustering to 10 groups (kmeans.n = 10).
set.seed(1234)
comp <- vqscompare(samplelist = list(s1, s2, s3, s4_fix),
lab_name = "Sample", kmeans.n = 10)
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>"
)
library(longreadvqs)
#Load sample 1.
sample1 <- system.file("extdata", "sample1.fasta", package = "longreadvqs")
#VQS diversity metrics of error minimized (10% cut-off) read alignment
vqssub(sample1, pct = 10, label = "sample1")
#Load samples 2 and 3.
sample2 <- system.file("extdata", "sample2.fasta", package = "longreadvqs")
sample3 <- system.file("extdata", "sample3.fasta", package = "longreadvqs")
#Error minimization (10% cut-off) and down-sampling (depth of 300)
a <- vqssub(sample1, pct = 10, samsize = 300, label = "sample1")
b <- vqssub(sample2, pct = 10, samsize = 300, label = "sample2")
c <- vqssub(sample3, pct = 10, samsize = 300, label = "sample3")
#Compare VQS diversity across three samples after error minimization and down-sampling.
rbind(a, b, c)
#Randomly down-sample from depth of 665 to 300, and 100 (10 iterations for each sample size).
set.seed(123)
c_full <- vqssub(sample3, pct = 10, label = "full_depth") #non-sampled alignment
c_300 <- do.call("rbind", replicate(10, vqssub(sample3, pct = 10,
samsize = 300, label = "depth_300"), simplify = FALSE)) #down-sample to depth of 300
c_100 <- do.call("rbind", replicate(10, vqssub(sample3, pct = 10,
samsize = 100, label = "depth_100"), simplify = FALSE)) #down-sample to depth of 100
all_c <- rbind(c_full, c_300, c_100) #combine data
#Load packages for visualization.
library(ggplot2)
library(cowplot)
all_c$depth <- as.character(all_c$depth)
depthorder <- c("665", "300", "100")
#Plot box-plots of three VQS metrics variation through different sampling depths.
haplotypes <- ggplot(all_c, aes(x = factor(depth, level=depthorder), y = haplotypes,
group = interaction(depth, label), fill = label)) + geom_boxplot() +
xlab("depth") + theme(legend.position = "none")
shannon <- ggplot(all_c, aes(x = factor(depth, level=depthorder), y = shannon,
group = interaction(depth, label), fill = label)) + geom_boxplot() +
xlab("depth") + theme(legend.position = "none")
gini_simpson <- ggplot(all_c, aes(x = factor(depth, level=depthorder), y = gini_simpson,
group = interaction(depth, label), fill = label)) + geom_boxplot() +
xlab("depth") + theme(legend.position = "none")
plot_grid(haplotypes, shannon, gini_simpson, nrow = 1)
#Generate complete VQS data for further comparison for each sample.
s1 <- vqsassess(sample1, pct = 10, samsize = 300, label = "sample1")
s2 <- vqsassess(sample2, pct = 10, samsize = 300, label = "sample2")
s3 <- vqsassess(sample3, pct = 10, samsize = 300, label = "sample3")
#Compare SNV profile between three samples.
snvcompare(samplelist = list(s1, s2, s3), ncol = 1)
#Load sample 4.
sample4 <- system.file("extdata", "mock.fasta", package = "longreadvqs")
s4 <- vqsassess(sample4, pct = 10, samsize = 300, label = "sample4")
#SNV profile of sample 4
s4$snv
#List outputs from "vqsassess" or "vqscustompct" that we want to compare into "vqscompare" function.
#Set the number of new OTU groups based on k-means clustering to 10 groups (kmeans.n = 10).
set.seed(1234)
comp <- vqscompare(samplelist = list(s1, s2, s3, s4_fix),
lab_name = "Sample", kmeans.n = 10)
#Use "vqscustompct" function to increase % cut-off after position 972 to 30%.
s4_fix <- vqscustompct(sample4, pct = 10, brkpos = c("1:971","972:982"), lspct = c(10,30),
samsize = 300, label = "sample4")
#SNV profile of sample 4 after % cut-off adjustment
s4_fix$snv
#List outputs from "vqsassess" or "vqscustompct" that we want to compare into "vqscompare" function.
#Set the number of new OTU groups based on k-means clustering to 10 groups (kmeans.n = 10).
set.seed(1234)
comp <- vqscompare(samplelist = list(s1, s2, s3, s4_fix),
lab_name = "Sample", kmeans.n = 10)
#The most important output of the "vqscompare" function is the summary plot.
comp$summaryplot
devtools::build_rmd("vignettes/my-vignette.Rmd")
devtools::build_rmd("vignettes/longreadvqs-vignette.Rmd")
library(longreadvqs)
devtools::load_all(".")
## Locate input FASTA files-----------------------------------------------------------------------
sample1filepath <- system.file("extdata", "sample1.fasta", package = "longreadvqs")
sample2filepath <- system.file("extdata", "sample2.fasta", package = "longreadvqs")
sample3filepath <- system.file("extdata", "sample3.fasta", package = "longreadvqs")
## Prepare data for viral quasispecies comparison between three samples---------------------------
sample1 <- vqsassess(sample1filepath, pct = 10, samsize = 100, label = "sample1")
sample2 <- vqsassess(sample2filepath, pct = 10, samsize = 100, label = "sample2")
sample3 <- vqsassess(sample3filepath, pct = 10, samsize = 100, label = "sample3")
snvcompare <- function(samplelist = list(BC1, BC2, BC3), ncol = 1, width = 1){
samplelist = samplelist
geom_barwidth <- function (..., width = width) {
geom_bar(..., width = width)
}
list.plot <- purrr::map(samplelist, "snv") %>% as.list()
list.plot2 <- list()
for(i in 1:length(list.plot)) {
list.plot2[[i]] <- list.plot[[i]] + geom_barwidth + theme(legend.position = "none")
}
legend <- suppressWarnings({cowplot::get_legend(list.plot[[1]])})
snvplot0 <- suppressWarnings({cowplot::plot_grid(plotlist = list.plot2, ncol = ncol, align = "v")})
snvplot <- suppressWarnings({cowplot::plot_grid(snvplot0, legend, ncol = 2, rel_widths = c(1, .1))})
return(snvplot)
}
snvcompare(samplelist = list(sample1, sample2, sample3), ncol = 1, width = 1)
snvcompare <- function(samplelist = list(BC1, BC2, BC3), ncol = 1, width = 1){
samplelist = samplelist
geom_barwidth <- function (..., width = width) {
geom_bar(..., width = width)
}
list.plot <- purrr::map(samplelist, "snv") %>% as.list()
list.plot2 <- list()
for(i in 1:length(list.plot)) {
list.plot2[[i]] <- list.plot[[i]] + geom_barwidth() + theme(legend.position = "none")
}
legend <- suppressWarnings({cowplot::get_legend(list.plot[[1]])})
snvplot0 <- suppressWarnings({cowplot::plot_grid(plotlist = list.plot2, ncol = ncol, align = "v")})
snvplot <- suppressWarnings({cowplot::plot_grid(snvplot0, legend, ncol = 2, rel_widths = c(1, .1))})
return(snvplot)
}
snvcompare(samplelist = list(sample1, sample2, sample3), ncol = 1, width = 1)
snvcompare <- function(samplelist = list(BC1, BC2, BC3), ncol = 1, barwidth = 1){
samplelist = samplelist
list.plot <- purrr::map(samplelist, "snv") %>% as.list()
list.plot2 <- list()
for(i in 1:length(list.plot)) {
list.plot2[[i]] <- list.plot[[i]] + geom_bar(width = barwidth) + theme(legend.position = "none")
}
legend <- suppressWarnings({cowplot::get_legend(list.plot[[1]])})
snvplot0 <- suppressWarnings({cowplot::plot_grid(plotlist = list.plot2, ncol = ncol, align = "v")})
snvplot <- suppressWarnings({cowplot::plot_grid(snvplot0, legend, ncol = 2, rel_widths = c(1, .1))})
return(snvplot)
}
snvcompare(samplelist = list(sample1, sample2, sample3), ncol = 1, barwidth = 1)
snvcompare <- function(samplelist = list(BC1, BC2, BC3), ncol = 1, barwidth = 1){
samplelist = samplelist
geom_barwidth <- function (..., width = barwidth) {
geom_bar(..., width = width)
}
list.plot <- purrr::map(samplelist, "snv") %>% as.list()
list.plot2 <- list()
for(i in 1:length(list.plot)) {
list.plot2[[i]] <- list.plot[[i]] + geom_barwidth() + theme(legend.position = "none")
}
legend <- suppressWarnings({cowplot::get_legend(list.plot[[1]])})
snvplot0 <- suppressWarnings({cowplot::plot_grid(plotlist = list.plot2, ncol = ncol, align = "v")})
snvplot <- suppressWarnings({cowplot::plot_grid(snvplot0, legend, ncol = 2, rel_widths = c(1, .1))})
return(snvplot)
}
snvcompare(samplelist = list(sample1, sample2, sample3), ncol = 1, barwidth = 1)
snvcompare <- function(samplelist = list(BC1, BC2, BC3), ncol = 1, barwidth = 1){
samplelist = samplelist
list.plot <- purrr::map(samplelist, "snv") %>% as.list()
list.plot2 <- list()
for(i in 1:length(list.plot)) {
list.plot2[[i]] <- list.plot[[i]] + geom_col(width = barwidth) + theme(legend.position = "none")
}
legend <- suppressWarnings({cowplot::get_legend(list.plot[[1]])})
snvplot0 <- suppressWarnings({cowplot::plot_grid(plotlist = list.plot2, ncol = ncol, align = "v")})
snvplot <- suppressWarnings({cowplot::plot_grid(snvplot0, legend, ncol = 2, rel_widths = c(1, .1))})
return(snvplot)
}
snvcompare(samplelist = list(sample1, sample2, sample3), ncol = 1, barwidth = 1)
snvcompare(samplelist = list(sample1, sample2, sample3), ncol = 1, barwidth = 2)
devtools::load_all(".")
devtools::load_all(".")
devtools::load_all(".")
## Locate input FASTA files-----------------------------------------------------------------------
sample1filepath <- system.file("extdata", "sample1.fasta", package = "longreadvqs")
sample2filepath <- system.file("extdata", "sample2.fasta", package = "longreadvqs")
sample3filepath <- system.file("extdata", "sample3.fasta", package = "longreadvqs")
## Prepare data for viral quasispecies comparison between three samples---------------------------
sample1 <- vqsassess(sample1filepath, pct = 10, samsize = 100, label = "sample1")
sample2 <- vqsassess(sample2filepath, pct = 10, samsize = 100, label = "sample2")
sample3 <- vqsassess(sample3filepath, pct = 10, samsize = 100, label = "sample3")
sample1$snv
snvcompare(samplelist = list(sample1, sample2, sample3), ncol = 1, barwidth = 2)
snvcompare <- function(samplelist = list(BC1, BC2, BC3), ncol = 1, barwidth = 1){
samplelist = samplelist
list.plot <- purrr::map(samplelist, "snv") %>% as.list()
list.plot2 <- list()
for(i in 1:length(list.plot)) {
list.plot2[[i]] <- list.plot[[i]] + geom_col(width = barwidth) + theme(legend.position = "none") + scale_y_continuous(labels = scales::percent_format(accuracy=1))
}
legend <- suppressWarnings({cowplot::get_legend(list.plot[[1]])})
snvplot0 <- suppressWarnings({cowplot::plot_grid(plotlist = list.plot2, ncol = ncol, align = "v")})
snvplot <- suppressWarnings({cowplot::plot_grid(snvplot0, legend, ncol = 2, rel_widths = c(1, .1))})
return(snvplot)
}
snvcompare(samplelist = list(sample1, sample2, sample3), ncol = 1, barwidth = 2)
devtools::load_all(".")
devtools::load_all(".")
## Locate input FASTA files-----------------------------------------------------------------------
sample1filepath <- system.file("extdata", "sample1.fasta", package = "longreadvqs")
sample2filepath <- system.file("extdata", "sample2.fasta", package = "longreadvqs")
sample3filepath <- system.file("extdata", "sample3.fasta", package = "longreadvqs")
## Prepare data for viral quasispecies comparison between three samples---------------------------
sample1 <- vqsassess(sample1filepath, pct = 10, samsize = 100, label = "sample1")
sample2 <- vqsassess(sample2filepath, pct = 10, samsize = 100, label = "sample2")
sample3 <- vqsassess(sample3filepath, pct = 10, samsize = 100, label = "sample3")
snvcompare(samplelist = list(sample1, sample2, sample3), ncol = 1, barwidth = 2)
devtools::load_all(".")
devtools::load_all(".")
sample1 <- system.file("extdata", "sample1.fasta", package = "longreadvqs")
pctopt(sample1, pctsing = 0, label = "sample1")
a <- pctopt(sample1, pctsing = 0, label = "sample1")
ggplot(a, aes(x=pct, y=pctsingleton)) +
geom_line() + geom_point()
devtools::load_all(".")
devtools::load_all(".")
devtools::load_all(".")
library(longreadvqs)
devtools::load_all(".")
d9_S <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144534_S.fasta", pctsing = 0, label = "d9_S")
d11_S <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144533_S.fasta", pctsing = 0, label = "d11_S")
d13_S <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144530_S.fasta", pctsing = 0, label = "d13_S")
d15_S <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144529_S.fasta", pctsing = 0, label = "d15_S")
d17_S <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144528_S.fasta", pctsing = 0, label = "d17_S")
d9_ORF3a <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144534_ORF3a.fasta", pctsing = 0, label = "d9_ORF3a")
d11_ORF3a <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144533_ORF3a.fasta", pctsing = 0, label = "d11_ORF3a")
d13_ORF3a <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144530_ORF3a.fasta", pctsing = 0, label = "d13_ORF3a")
d15_ORF3a <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144529_ORF3a.fasta", pctsing = 0, label = "d15_ORF3a")
d17_ORF3a <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144528_ORF3a.fasta", pctsing = 0, label = "d17_ORF3a")
d9_E <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144534_E.fasta", pctsing = 0, label = "d9_E")
d11_E <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144533_E.fasta", pctsing = 0, label = "d11_E")
d13_E <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144530_E.fasta", pctsing = 0, label = "d13_E")
d15_E <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144529_E.fasta", pctsing = 0, label = "d15_E")
d17_E <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144528_E.fasta", pctsing = 0, label = "d17_E")
d9_M <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144534_M.fasta", pctsing = 0, label = "d9_M")
d11_M <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144533_M.fasta", pctsing = 0, label = "d11_M")
d13_M <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144530_M.fasta", pctsing = 0, label = "d13_M")
d15_M <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144529_M.fasta", pctsing = 0, label = "d15_M")
d17_M <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144528_M.fasta", pctsing = 0, label = "d17_M")
d9_ORF6 <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144534_ORF6.fasta", pctsing = 0, label = "d9_ORF6")
d11_ORF6 <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144533_ORF6.fasta", pctsing = 0, label = "d11_ORF6")
d13_ORF6 <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144530_ORF6.fasta", pctsing = 0, label = "d13_ORF6")
d15_ORF6 <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144529_ORF6.fasta", pctsing = 0, label = "d15_ORF6")
d17_ORF6 <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144528_ORF6.fasta", pctsing = 0, label = "d17_ORF6")
d9_StoORF6 <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144534_StoORF6.fasta", pctsing = 0, label = "d9_StoORF6")
d11_StoORF6 <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144533_StoORF6.fasta", pctsing = 0, label = "d11_StoORF6")
d13_StoORF6 <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144530_StoORF6.fasta", pctsing = 0, label = "d13_StoORF6")
d15_StoORF6 <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144529_StoORF6.fasta", pctsing = 0, label = "d15_StoORF6")
d17_StoORF6 <- pctopt("~/Desktop/bioproj/02newer/sarscov2/pacbio/samfasta/gene/sarscov2pacbiosub/SRR13144528_StoORF6.fasta", pctsing = 0, label = "d17_StoORF6")
sarscov2pacbio <- rbind(d9_S, d11_S, d13_S, d15_S, d17_S, d9_ORF3a, d11_ORF3a, d13_ORF3a, d15_ORF3a, d17_ORF3a, d9_E, d11_E, d13_E, d15_E, d17_E, d9_M, d11_M, d13_M, d15_M, d17_M, d9_ORF6, d11_ORF6, d13_ORF6, d15_ORF6, d17_ORF6, d9_StoORF6, d11_StoORF6, d13_StoORF6, d15_StoORF6, d17_StoORF6)
sarscov2pacbio <- sarscov2pacbio %>% separate_wider_delim(label, "_", names = c("sample", "gene"))
write.table(sarscov2pacbio, file = "~/Desktop/bioproj/02newer/sarscov2/pacbio/optpctsarscov2pacbio.tsv", sep = "\t", row.names = FALSE, quote = FALSE)
sarscov2pacbio$gene <- factor(sarscov2pacbio$gene, levels = c("StoORF6", "S", "ORF3a", "M", "E", "ORF6"), ordered = TRUE)
ggplot(sarscov2pacbio, aes(x=pct, y=pctsingleton, group=sample)) +
geom_line(aes(color=sample)) +
geom_point(aes(color=sample)) +
facet_wrap(vars(gene), nrow = 6)
pt11.rev <- vqsassess("~/Desktop/bioproj/02newer/hiv/pacbio/samfasta/gene/hivpacbiosub/SRR16343685_rev.fasta", pct = 35, samsize = 1000, label = "pt11.rev")
devtools::load_all(".")
pt11.rev <- vqsassess("~/Desktop/bioproj/02newer/hiv/pacbio/samfasta/gene/hivpacbiosub/SRR16343685_rev.fasta", pct = 35, samsize = 1000, label = "pt11.rev")
pt12.rev <- vqsassess("~/Desktop/bioproj/02newer/hiv/pacbio/samfasta/gene/hivpacbiosub/SRR16343684_rev.fasta", pct = 35, samsize = 1000, label = "pt12.rev")
pt21.rev <- vqsassess("~/Desktop/bioproj/02newer/hiv/pacbio/samfasta/gene/hivpacbiosub/SRR16343683_rev.fasta", pct = 35, samsize = 1000, label = "pt21.rev")
pt22.rev <- vqsassess("~/Desktop/bioproj/02newer/hiv/pacbio/samfasta/gene/hivpacbiosub/SRR16343682_rev.fasta", pct = 35, samsize = 1000, label = "pt22.rev")
snvcompare(samplelist = list(pt11.rev, pt12.rev, pt21.rev, pt22.rev), ncol = 1)
comprev <- vqscompare(samplelist = list(pt11.rev, pt12.rev, pt21.rev, pt22.rev),
lab_name = "Sample", kmeans.n = 10)
comprev$summaryplot
pt11.env <- vqsassess("~/Desktop/bioproj/02newer/hiv/pacbio/samfasta/gene/hivpacbiosub/SRR16343685_env.fasta", pct = 35, samsize = 1000, label = "pt11.env")
pt11.env <- vqsassess("~/Desktop/bioproj/02newer/hiv/pacbio/samfasta/gene/hivpacbiosub/SRR16343685_env.fasta", pct = 35, samsize = 1000, label = "pt11.env")
pt12.env <- vqsassess("~/Desktop/bioproj/02newer/hiv/pacbio/samfasta/gene/hivpacbiosub/SRR16343684_env.fasta", pct = 35, samsize = 1000, label = "pt12.env")
pt21.env <- vqsassess("~/Desktop/bioproj/02newer/hiv/pacbio/samfasta/gene/hivpacbiosub/SRR16343683_env.fasta", pct = 35, samsize = 1000, label = "pt21.env")
pt22.env <- vqsassess("~/Desktop/bioproj/02newer/hiv/pacbio/samfasta/gene/hivpacbiosub/SRR16343682_env.fasta", pct = 35, samsize = 1000, label = "pt22.env")
snvcompare(samplelist = list(pt11.env, pt12.env, pt21.env, pt22.env), ncol = 1)
compenv <- vqscompare(samplelist = list(pt11.env, pt12.env, pt21.env, pt22.env),
lab_name = "Sample", kmeans.n = 10)
compenv$summaryplot
devtools::load_all(".")
git remote add origin https://github.com/NakarinP/longreadvqs
usethis::create_from_github(
"https://github.com/NakarinP/longreadvqs.git",
destdir = "/Users/nakarinpamornchainavakul/longreadvqs"
)
git remote add origin https://github.com/NakarinP/longreadvqs.git
